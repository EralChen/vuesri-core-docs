import{gS as E,lm as O,np as A,gY as k,lB as y,c6 as F,gZ as _,h2 as w,oC as j,sH as B,gT as i,ly as S,gX as T,lD as $,h7 as C,g$ as M,h8 as V,ha as H,h4 as G,lF as L,oA as N,hb as I,hi as U}from"./chunk-oRXQYLok.js";import{u as D}from"./chunk-IGmq6gCy.js";import"./chunk-8ucAXuuz.js";import{u as X}from"./chunk-yIcxEGwK.js";import{u as Y}from"./chunk-2DW_cBUC.js";function Z(){const e=E("vaSketch");if(!e)throw new Error("The component which use useSketch() must be in a Sketch component");return e}const v={modelValue:{type:[Array,Object],default:()=>[]},multiple:{type:Boolean,default:!0}},q=O(v),p={"update:modelValue":e=>e,complete:e=>e,update:e=>!0,create:e=>!0},x=A(p),z={...v,defaultOptions:{type:Object,default:()=>({})},availableCreatureTools:{type:Array,default:void 0},position:{type:String,default:"top-right"},orphan:{type:Boolean,default:!1},modelValueInitFrom:{type:String,default:"modelValue"},viewModelPointSymbol:{type:Object},viewModelPolygonSymbol:{type:Object},viewModelPolylineSymbol:{type:Object},viewModelActiveFillSymbol:{type:Object},visibleElements:{type:Object,default:void 0}},J=q,K={load:e=>e,...p},Q=x,R=k({props:v,emits:p,setup(e,{emit:l}){const s=Z(),n=X(),a=s.on("create",o=>{l("create",o),o.state==="start"?e.multiple||n.removeAll():o.state==="complete"&&(!e.multiple&&n.graphics.length>1&&o.graphic.geometry.type==="point"&&n.remove(n.graphics.getItemAt(0)),l("update:modelValue",[...n.graphics]),l("complete",o))});y(()=>{a.remove()});const c=s.on("update",o=>{l("update",o),o.state==="complete"&&(l("update:modelValue",[...n.graphics]),l("complete",o))});return y(()=>{c.remove()}),()=>null}}),W=k({name:"VaSketch",components:{Events:R},props:z,emits:K,setup(e,{emit:l}){const s=D(),n=s.map;let a=E("vaGraphicsLayer",null);a||(a=new F,n.add(a));const c=J(e),o=Q(l);function h(t){a.removeAll(),a.addMany(t)}_(()=>e.modelValue,(t,r)=>{let m=!1;if(t.length===r.length){for(let d=0;d<t.length;d++)if(t[d]!==r[d]){m=!0;break}}else m=!0;m&&h([...t])}),e.modelValueInitFrom==="layerGraphics"?l("update:modelValue",a.graphics):h(e.modelValue);const f=w(),g=w(!1);class P extends T{toggleVisible(){n.ground.layers.forEach(r=>{r.visible=!r.visible})}add(){this.toggleVisible(),this.removeHandler=this.toggleVisible.bind(this)}}const b=new P;return j(()=>{const t=new B({container:f.value,view:s,layer:a,creationMode:"single",...e.defaultOptions});i(()=>{e.visibleElements&&(t.visibleElements=e.visibleElements)}),i(()=>{e.viewModelPointSymbol&&(t.viewModel.pointSymbol=e.viewModelPointSymbol)}),i(()=>{e.viewModelPolylineSymbol&&(t.viewModel.polylineSymbol=e.viewModelPolylineSymbol)}),i(()=>{e.viewModelPolygonSymbol&&(t.viewModel.polygonSymbol=e.viewModelPolygonSymbol)}),i(()=>{e.viewModelActiveFillSymbol&&(t.viewModel.activeFillSymbol=e.viewModelActiveFillSymbol)}),i(()=>{e.availableCreatureTools&&(t.availableCreateTools=e.availableCreatureTools)}),y(()=>{t.destroy()}),Y(s.ui,t,e),S("vaGraphicsLayer",a),S("vaSketch",t),g.value=!0,b.add(),t.when(()=>{b.remove()}),l("load",{sketch:t,view:s})}),{eventsBindProps:c,eventsOnEmits:o,sketchNode:f,ready:g}}}),ee={ref:"sketchNode"};function te(e,l,s,n,a,c){const o=C("Events");return M(),V("div",ee,[e.ready?(M(),V(H,{key:0},[G(o,L(e.eventsBindProps,N(e.eventsOnEmits)),null,16),I(e.$slots,"default")],64)):U("",!0)],512)}const u=$(W,[["render",te]]);u.install=e=>{e.component(u.name,u)};export{u as V};

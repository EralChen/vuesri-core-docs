import{V as R}from"./chunk-BY_FN4O4.js";import{V as O}from"./chunk-B4Rwpdzs.js";import{u as S}from"./chunk-Dc5RCiI0.js";import{gJ as $,gO as M,ck as z,lC as A,gL as b,gM as j,lE as H,h1 as U,gR as B,gS as F,gV as E,gW as l,gT as s}from"./chunk-CMhy9c9G.js";import{s as N}from"./chunk-DHvBO4SR.js";import{c as P}from"./chunk-35-ZZMVr.js";import{V as q}from"./chunk-BVa6-kjc.js";import"./chunk-DobUN8tB.js";import"./chunk-Ch0SDxT-.js";/* empty css              */import"./chunk--OMOLJvv.js";import"./chunk-hcQCkdqJ.js";import"./chunk-Cj_Zd08g.js";import"./chunk-igt1gBeK.js";import"./chunk-BqmX71u_.js";import"./chunk-2F9zfzHu.js";import"./chunk-DfjCgXDb.js";import"./chunk-CNtoRp8i.js";import"./chunk-ByM7454y.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import"./chunk-DAZPr-5t.js";import"./chunk-Dz7Zvk-S.js";function D(){const o=$("vaWmtsLayer");if(!o)throw new Error("The component which use useWmtsLayer() must be in a WmtsLayer component");return o}const J={modelValue:{type:Object,default:()=>({})}},X={click:o=>o},G=M({name:"VaWmtsLayerOnClick",props:J,emits:X,setup(o,{emit:i}){const e=S(),t=D(),r=e[N],u=P(r),a=new u("click",async d=>{const{event:I}=d,c=t.activeLayer;await t.when();const f=I.mapPoint,y=c.id,p=c.tileMatrixSet.tileInfo,L=p.origin,k=e.zoom,n=p.lods.find(C=>C.level===k+1);if(!n)return;const[v,w]=p.size,g=(f.x-L.x)/(n.resolution*v),h=(L.y-f.y)/(n.resolution*w);var _=Math.floor(g),V=Math.floor(h);const W=Math.round((g-_)*v),x=Math.round((h-V)*w);let T;y&&(T=await z(t.url,{query:{SERVICE:"WMTS",LAYER:y,REQUEST:"GetFeatureInfo",VERSION:"1.0.0",INFOFORMAT:"application/json",TILECOL:_,TILEROW:V,TILEMATRIX:n.levelValue,TILEMATRIXSET:c.tileMatrixSet.id,I:W,J:x}}).catch(()=>{})),i("click",{...d,requestResponse:T})});return a.add(),A(()=>{a.remove()}),b(()=>{a.remove()}),j(()=>{a.add()}),{}}});function K(o,i,e,t,r,u){return U(o.$slots,"default")}const m=H(G,[["render",K]]);m.install=o=>{o.component(m.name,m)};const Q="http://192.168.110.10:36800/zzserver/gwc/service/wmts",Qt=M({__name:"basic",setup(o){const i=t=>{const r=t.view;console.log("wmtsLayerLoad",t.layer),t.layer.when().then(()=>{t.layer.activeLayer?.fullExtent&&r.goTo(t.layer.activeLayer.fullExtent)})},e=t=>{console.log("layerClick",t)};return(t,r)=>(B(),F(s(R),{"default-options":{zoom:2}},{default:E(()=>[l(s(O),{type:"vec_w",anno:!1,"spatial-reference":{wkid:3857}}),l(s(q),{url:Q,title:"testLayer","service-mode":"KVP",onLoad:i},{default:E(()=>[l(s(m),{onClick:e})]),_:1})]),_:1}))}});export{Qt as default};

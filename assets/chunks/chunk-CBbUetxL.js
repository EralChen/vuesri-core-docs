import{y as on,c as ln,d as cn,N,x as fn,Z as dn,t as B,g as un,r as C}from"./chunk-CBTaaEty.js";import{o as d,i as m,k as W,g as H,t as V,d as k,a as i,r as s,E as g,X as P,A as J,K as M,Y as w,a0 as K,a1 as j,a2 as q,h as R,S as wn,z,B as S}from"./chunk-BSi4oUWq.js";import{c as I,r as L,b as p}from"./chunk-YA9YD_OS.js";import{l as X}from"./chunk-y7cu5d_k.js";import{cO as mn,ck as Y,hb as u,aH as T,aM as A,aL as O,a3 as D,im as G,c7 as Q,q as _,ip as hn}from"./chunk-CMhy9c9G.js";import{disjoint as pn,intersects as yn,touches as vn,crosses as gn,within as Pn,contains as In,overlaps as An,equals as Fn,relate as Rn,intersect as bn,union as Nn,difference as Sn,symmetricDifference as On,clip as Dn,cut as jn,planarArea as x,geodesicArea as $,planarLength as U,geodesicLength as E,distance as Ln,densify as nn,geodesicDensify as en,generalize as Tn,buffer as Cn,geodesicBuffer as Jn,offset as Mn,rotate as tn,simplify as rn,isSimple as Un,convexHull as Zn,nearestCoordinate as kn,nearestVertex as qn}from"./chunk-DwRtZjYO.js";import"./chunk-ByM7454y.js";import"./chunk-BPVd6ESQ.js";import"./chunk-DaLUiyab.js";import"./chunk-CeYath0a.js";import"./chunk-CcEbRgUF.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */async function an(a,e,t){if(!mn?.findCredential(a.restUrl))return null;if(a.loadStatus==="loaded"&&e===""&&a.user?.sourceJSON&&t===!1)return a.user.sourceJSON;const c={responseType:"json",query:{f:"json"}};if(t&&(c.query.returnUserLicenseTypeExtensions=!0),e===""){const r=await Y(a.restUrl+"/community/self",c);if(r.data){const o=r.data;if(o?.username)return o}return null}const n=await Y(a.restUrl+"/community/users/"+e,c);if(n.data){const r=n.data;return r.error?null:r}return null}function F(a,e,t){if(m(a,2,2,e,t),!(a[0]instanceof u&&a[1]instanceof u)){if(!(a[0]instanceof u&&a[1]===null)){if(!(a[1]instanceof u&&a[0]===null)){if(a[0]!==null||a[1]!==null)throw new i(e,s.InvalidParameter,t)}}}}async function sn(a,e){if(a.type!=="polygon"&&a.type!=="polyline"&&a.type!=="extent")return 0;let t=1;(a.spatialReference.vcsWkid||a.spatialReference.latestVcsWkid)&&(t=un(a.spatialReference)/hn(a.spatialReference));let l=0;if(a.type==="polyline")for(const n of a.paths)for(let r=1;r<n.length;r++)l+=C(n[r],n[r-1],t);else if(a.type==="polygon")for(const n of a.rings){for(let r=1;r<n.length;r++)l+=C(n[r],n[r-1],t);(n[0][0]!==n[n.length-1][0]||n[0][1]!==n[n.length-1][1]||n[0][2]!==void 0&&n[0][2]!==n[n.length-1][2])&&(l+=C(n[0],n[n.length-1],t))}else a.type==="extent"&&(l+=2*C([a.xmin,a.ymin,0],[a.xmax,a.ymin,0],t),l+=2*C([a.xmin,a.ymin,0],[a.xmin,a.ymax,0],t),l*=2,l+=4*Math.abs(w(a.zmax,0)*t-w(a.zmin,0)*t));const c=new A({hasZ:!1,hasM:!1,spatialReference:a.spatialReference,paths:[[[0,0],[0,l]]]});return U(c,e)}function De(a){a.mode==="async"&&(a.functions.disjoint=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>(F(n=d(n),e,t),n[0]===null||n[1]===null||pn(n[0],n[1])))},a.functions.intersects=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>(F(n=d(n),e,t),n[0]!==null&&n[1]!==null&&yn(n[0],n[1])))},a.functions.touches=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>(F(n=d(n),e,t),n[0]!==null&&n[1]!==null&&vn(n[0],n[1])))},a.functions.crosses=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>(F(n=d(n),e,t),n[0]!==null&&n[1]!==null&&gn(n[0],n[1])))},a.functions.within=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>(F(n=d(n),e,t),n[0]!==null&&n[1]!==null&&Pn(n[0],n[1])))},a.functions.contains=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>(F(n=d(n),e,t),n[0]!==null&&n[1]!==null&&In(n[0],n[1])))},a.functions.overlaps=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>(F(n=d(n),e,t),n[0]!==null&&n[1]!==null&&An(n[0],n[1])))},a.functions.equals=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>(m(n,2,2,e,t),n[0]===n[1]||(n[0]instanceof u&&n[1]instanceof u?Fn(n[0],n[1]):(W(n[0])&&W(n[1])||!!(H(n[0])&&H(n[1])||V(n[0])&&V(n[1])))&&n[0].equals(n[1]))))},a.functions.relate=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>{if(n=d(n),m(n,3,3,e,t),n[0]instanceof u&&n[1]instanceof u)return Rn(n[0],n[1],k(n[2]));if(n[0]instanceof u&&n[1]===null||n[1]instanceof u&&n[0]===null||n[0]===null&&n[1]===null)return!1;throw new i(e,s.InvalidParameter,t)})},a.functions.intersection=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>(F(n=d(n),e,t),n[0]===null||n[1]===null?null:bn(n[0],n[1])))},a.functions.union=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>{const r=[];if((n=d(n)).length===0)throw new i(e,s.WrongNumberOfParameters,t);if(n.length===1)if(g(n[0])){const o=d(n[0]);for(let f=0;f<o.length;f++)if(o[f]!==null){if(!(o[f]instanceof u))throw new i(e,s.InvalidParameter,t);r.push(o[f])}}else{if(!P(n[0])){if(n[0]instanceof u)return J(I(n[0]),e.spatialReference);if(n[0]===null)return null;throw new i(e,s.InvalidParameter,t)}{const o=d(n[0].toArray());for(let f=0;f<o.length;f++)if(o[f]!==null){if(!(o[f]instanceof u))throw new i(e,s.InvalidParameter,t);r.push(o[f])}}}else for(let o=0;o<n.length;o++)if(n[o]!==null){if(!(n[o]instanceof u))throw new i(e,s.InvalidParameter,t);r.push(n[o])}return r.length===0?null:Nn(r)})},a.functions.difference=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>(F(n=d(n),e,t),n[0]===null?null:n[1]===null?I(n[0]):Sn(n[0],n[1])))},a.functions.symmetricdifference=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>(F(n=d(n),e,t),n[0]===null&&n[1]===null?null:n[0]===null?I(n[1]):n[1]===null?I(n[0]):On(n[0],n[1])))},a.functions.clip=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>{if(n=d(n),m(n,2,2,e,t),!(n[1]instanceof T)&&n[1]!==null)throw new i(e,s.InvalidParameter,t);if(n[0]===null)return null;if(!(n[0]instanceof u))throw new i(e,s.InvalidParameter,t);return n[1]===null?null:Dn(n[0],n[1])})},a.functions.cut=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>{if(n=d(n),m(n,2,2,e,t),!(n[1]instanceof A)&&n[1]!==null)throw new i(e,s.InvalidParameter,t);if(n[0]===null)return[];if(!(n[0]instanceof u))throw new i(e,s.InvalidParameter,t);return n[1]===null?[I(n[0])]:jn(n[0],n[1])})},a.functions.area=function(e,t){return a.standardFunctionAsync(e,t,async(l,c,n)=>{if(m(n,1,2,e,t),(n=d(n))[0]===null)return 0;if(M(n[0])){const r=await n[0].sumArea(L(w(n[1],-1)),!1,e.abortSignal);if(e.abortSignal.aborted)throw new i(e,s.Cancelled,t);return r}if(g(n[0])||P(n[0])){const r=K(n[0],e.spatialReference);return r===null?0:x(r,L(w(n[1],-1)))}if(!(n[0]instanceof u))throw new i(e,s.InvalidParameter,t);return x(n[0],L(w(n[1],-1)))})},a.functions.areageodetic=function(e,t){return a.standardFunctionAsync(e,t,async(l,c,n)=>{if(m(n,1,2,e,t),(n=d(n))[0]===null)return 0;if(M(n[0])){const r=await n[0].sumArea(L(w(n[1],-1)),!0,e.abortSignal);if(e.abortSignal.aborted)throw new i(e,s.Cancelled,t);return r}if(g(n[0])||P(n[0])){const r=K(n[0],e.spatialReference);return r===null?0:$(r,L(w(n[1],-1)))}if(!(n[0]instanceof u))throw new i(e,s.InvalidParameter,t);return $(n[0],L(w(n[1],-1)))})},a.functions.length=function(e,t){return a.standardFunctionAsync(e,t,async(l,c,n)=>{if(m(n,1,2,e,t),(n=d(n))[0]===null)return 0;if(M(n[0])){const r=await n[0].sumLength(p(w(n[1],-1)),!1,e.abortSignal);if(e.abortSignal.aborted)throw new i(e,s.Cancelled,t);return r}if(g(n[0])||P(n[0])){const r=j(n[0],e.spatialReference);return r===null?0:U(r,p(w(n[1],-1)))}if(!(n[0]instanceof u))throw new i(e,s.InvalidParameter,t);return U(n[0],p(w(n[1],-1)))})},a.functions.length3d=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>{if(m(n,1,2,e,t),(n=d(n))[0]===null)return 0;if(g(n[0])||P(n[0])){const r=j(n[0],e.spatialReference);return r===null?0:r.hasZ===!0?sn(r,p(w(n[1],-1))):U(r,p(w(n[1],-1)))}if(!(n[0]instanceof u))throw new i(e,s.InvalidParameter,t);return n[0].hasZ===!0?sn(n[0],p(w(n[1],-1))):U(n[0],p(w(n[1],-1)))})},a.functions.lengthgeodetic=function(e,t){return a.standardFunctionAsync(e,t,async(l,c,n)=>{if(m(n,1,2,e,t),(n=d(n))[0]===null)return 0;if(M(n[0])){const r=await n[0].sumLength(p(w(n[1],-1)),!0,e.abortSignal);if(e.abortSignal.aborted)throw new i(e,s.Cancelled,t);return r}if(g(n[0])||P(n[0])){const r=j(n[0],e.spatialReference);return r===null?0:E(r,p(w(n[1],-1)))}if(!(n[0]instanceof u))throw new i(e,s.InvalidParameter,t);return E(n[0],p(w(n[1],-1)))})},a.functions.distance=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>{n=d(n),m(n,2,3,e,t);let r=n[0];(g(n[0])||P(n[0]))&&(r=q(n[0],e.spatialReference));let o=n[1];if((g(n[1])||P(n[1]))&&(o=q(n[1],e.spatialReference)),!(r instanceof u))throw new i(e,s.InvalidParameter,t);if(!(o instanceof u))throw new i(e,s.InvalidParameter,t);return Ln(r,o,p(w(n[2],-1)))})},a.functions.distancegeodetic=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>{n=d(n),m(n,2,3,e,t);const r=n[0],o=n[1];if(!(r instanceof O))throw new i(e,s.InvalidParameter,t);if(!(o instanceof O))throw new i(e,s.InvalidParameter,t);const f=new A({paths:[],spatialReference:r.spatialReference});return f.addPath([r,o]),E(f,p(w(n[2],-1)))})},a.functions.densify=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>{if(n=d(n),m(n,2,3,e,t),n[0]===null)return null;if(!(n[0]instanceof u))throw new i(e,s.InvalidParameter,t);const r=R(n[1]);if(isNaN(r))throw new i(e,s.InvalidParameter,t);if(r<=0)throw new i(e,s.InvalidParameter,t);return n[0]instanceof D||n[0]instanceof A?nn(n[0],r,p(w(n[2],-1))):n[0]instanceof T?nn(D.fromExtent(n[0]),r,p(w(n[2],-1))):n[0]})},a.functions.densifygeodetic=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>{if(n=d(n),m(n,2,3,e,t),n[0]===null)return null;if(!(n[0]instanceof u))throw new i(e,s.InvalidParameter,t);const r=R(n[1]);if(isNaN(r))throw new i(e,s.InvalidParameter,t);if(r<=0)throw new i(e,s.InvalidParameter,t);return n[0]instanceof D||n[0]instanceof A?en(n[0],r,p(w(n[2],-1))):n[0]instanceof T?en(D.fromExtent(n[0]),r,p(w(n[2],-1))):n[0]})},a.functions.generalize=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>{if(n=d(n),m(n,2,4,e,t),n[0]===null)return null;if(!(n[0]instanceof u))throw new i(e,s.InvalidParameter,t);const r=R(n[1]);if(isNaN(r))throw new i(e,s.InvalidParameter,t);return Tn(n[0],r,wn(w(n[2],!0)),p(w(n[3],-1)))})},a.functions.buffer=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>{if(n=d(n),m(n,2,3,e,t),n[0]===null)return null;if(!(n[0]instanceof u))throw new i(e,s.InvalidParameter,t);const r=R(n[1]);if(isNaN(r))throw new i(e,s.InvalidParameter,t);return r===0?I(n[0]):Cn(n[0],r,p(w(n[2],-1)))})},a.functions.buffergeodetic=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>{if(n=d(n),m(n,2,3,e,t),n[0]===null)return null;if(!(n[0]instanceof u))throw new i(e,s.InvalidParameter,t);const r=R(n[1]);if(isNaN(r))throw new i(e,s.InvalidParameter,t);return r===0?I(n[0]):Jn(n[0],r,p(w(n[2],-1)))})},a.functions.offset=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>{if(n=d(n),m(n,2,6,e,t),n[0]===null)return null;if(!(n[0]instanceof D||n[0]instanceof A))throw new i(e,s.InvalidParameter,t);const r=R(n[1]);if(isNaN(r))throw new i(e,s.InvalidParameter,t);const o=R(w(n[4],10));if(isNaN(o))throw new i(e,s.InvalidParameter,t);const f=R(w(n[5],0));if(isNaN(f))throw new i(e,s.InvalidParameter,t);return Mn(n[0],r,p(w(n[2],-1)),k(w(n[3],"round")).toLowerCase(),o,f)})},a.functions.rotate=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>{if(n=d(n),m(n,2,3,e,t),n[0]===null)return null;if(!(n[0]instanceof u))throw new i(e,s.InvalidParameter,t);const r=n[0]instanceof T?D.fromExtent(n[0]):n[0],o=R(n[1]);if(isNaN(o))throw new i(e,s.InvalidParameter,t);const f=w(n[2],null);if(f===null)return tn(r,o);if(f instanceof O)return tn(r,o,f);throw new i(e,s.InvalidParameter,t)})},a.functions.centroid=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>{if(n=d(n),m(n,1,1,e,t),n[0]===null)return null;let r=n[0];if((g(n[0])||P(n[0]))&&(r=q(n[0],e.spatialReference)),r===null)return null;if(!(r instanceof u))throw new i(e,s.InvalidParameter,t);return r instanceof O?J(I(r),e.spatialReference):r instanceof D?r.centroid:r instanceof A?on(r):r instanceof G?ln(r):r instanceof T?r.center:null})},a.functions.measuretocoordinate=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>{if(n=d(n),m(n,2,2,e,t),n[0]===null)return null;let r=n[0];if((g(n[0])||P(n[0]))&&(r=j(n[0],e.spatialReference)),r===null)return null;if(!(r instanceof u))throw new i(e,s.InvalidParameter,t);if(!(r instanceof A))throw new i(e,s.InvalidParameter,t);if(z(n[1]===!1))throw new i(e,s.InvalidParameter,t);const o=cn(r,n[1]);return o?N.convertObjectToArcadeDictionary(o,S(e),!1,!0):null})},a.functions.pointtocoordinate=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>{if(n=d(n),m(n,2,2,e,t),n[0]===null)return null;let r=n[0];if((g(n[0])||P(n[0]))&&(r=j(n[0],e.spatialReference)),r===null)return null;if(!(r instanceof u))throw new i(e,s.InvalidParameter,t);if(!(r instanceof A))throw new i(e,s.InvalidParameter,t);const o=n[1];if(o===null)return null;if(!(o instanceof O))throw new i(e,s.InvalidParameter,t);if(z(n[1]===!1))throw new i(e,s.InvalidParameter,t);const f=fn(r,o);return f?N.convertObjectToArcadeDictionary(f,S(e),!1,!0):null})},a.functions.distancetocoordinate=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>{if(n=d(n),m(n,2,2,e,t),n[0]===null)return null;let r=n[0];if((g(n[0])||P(n[0]))&&(r=j(n[0],e.spatialReference)),r===null)return null;if(!(r instanceof u))throw new i(e,s.InvalidParameter,t);if(!(r instanceof A))throw new i(e,s.InvalidParameter,t);if(z(n[1]===!1))throw new i(e,s.InvalidParameter,t);const o=dn(r,n[1]);return o?N.convertObjectToArcadeDictionary(o,S(e),!1,!0):null})},a.functions.multiparttosinglepart=function(e,t){return a.standardFunctionAsync(e,t,async(l,c,n)=>{if(n=d(n),m(n,1,1,e,t),n[0]===null)return null;if(!(n[0]instanceof u))throw new i(e,s.InvalidParameter,t);if(n[0]instanceof O)return[J(I(n[0]),e.spatialReference)];if(n[0]instanceof T)return[J(I(n[0]),e.spatialReference)];const r=await rn(n[0]);if(r instanceof D){const o=[],f=[];for(let h=0;h<r.rings.length;h++)if(r.isClockwise(r.rings[h])){const y=Q({rings:[r.rings[h]],hasZ:r.hasZ===!0,hasM:r.hasM===!0,spatialReference:r.spatialReference.toJSON()});o.push(y)}else f.push({ring:r.rings[h],pt:r.getPoint(h,0)});for(let h=0;h<f.length;h++)for(let y=0;y<o.length;y++)if(o[y].contains(f[h].pt)){o[y].addRing(f[h].ring);break}return o}if(r instanceof A){const o=[];for(let f=0;f<r.paths.length;f++){const h=Q({paths:[r.paths[f]],hasZ:r.hasZ===!0,hasM:r.hasM===!0,spatialReference:r.spatialReference.toJSON()});o.push(h)}return o}if(n[0]instanceof G){const o=[],f=J(I(n[0]),e.spatialReference);for(let h=0;h<f.points.length;h++)o.push(f.getPoint(h));return o}return null})},a.functions.issimple=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>{if(n=d(n),m(n,1,1,e,t),n[0]===null)return!0;if(!(n[0]instanceof u))throw new i(e,s.InvalidParameter,t);return Un(n[0])})},a.functions.simplify=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>{if(n=d(n),m(n,1,1,e,t),n[0]===null)return null;if(!(n[0]instanceof u))throw new i(e,s.InvalidParameter,t);return rn(n[0])})},a.functions.convexhull=function(e,t){return a.standardFunctionAsync(e,t,(l,c,n)=>{if(n=d(n),m(n,1,1,e,t),n[0]===null)return null;if(!(n[0]instanceof u))throw new i(e,s.InvalidParameter,t);return Zn(n[0])})},a.functions.getuser=function(e,t){return a.standardFunctionAsync(e,t,async(l,c,n)=>{m(n,0,2,e,t);let r=w(n[1],""),o=r===!0;if(r=r===!0||r===!1?"":k(r),n.length===0||n[0]instanceof B){let h;h=e.services?.portal?e.services.portal:_.getDefault(),n.length>0&&(h=X(n[0],h));const y=await an(h,r,o);if(y){const b=JSON.parse(JSON.stringify(y));for(const v of["lastLogin","created","modified"])b[v]!==void 0&&b[v]!==null&&(b[v]=new Date(b[v]));return N.convertObjectToArcadeDictionary(b,S(e))}return null}let f=null;if(M(n[0])&&(f=n[0]),f){if(o=!1,r)return null;await f.load();const h=await f.getOwningSystemUrl();if(!h){if(!r){const v=await f.getIdentityUser();return v?N.convertObjectToArcadeDictionary({username:v},S(e)):null}return null}let y;y=e.services?.portal?e.services.portal:_.getDefault(),y=X(new B(h),y);const b=await an(y,r,o);if(b){const v=JSON.parse(JSON.stringify(b));for(const Z of["lastLogin","created","modified"])v[Z]!==void 0&&v[Z]!==null&&(v[Z]=new Date(v[Z]));return N.convertObjectToArcadeDictionary(v,S(e))}return null}throw new i(e,s.InvalidParameter,t)})},a.functions.nearestcoordinate=function(e,t){return a.standardFunctionAsync(e,t,async(l,c,n)=>{if(n=d(n),m(n,2,2,e,t),!(n[0]instanceof u||n[0]===null))throw new i(e,s.InvalidParameter,t);if(!(n[1]instanceof O||n[1]===null))throw new i(e,s.InvalidParameter,t);if(n[0]===null||n[1]===null)return null;const r=await kn(n[0],n[1]);return r===null?null:N.convertObjectToArcadeDictionary({coordinate:r.coordinate,distance:r.distance,sideOfLine:r.distance===0?"straddle":r.isRightSide?"right":"left"},S(e),!1,!0)})},a.functions.nearestvertex=function(e,t){return a.standardFunctionAsync(e,t,async(l,c,n)=>{if(n=d(n),m(n,2,2,e,t),!(n[0]instanceof u||n[0]===null))throw new i(e,s.InvalidParameter,t);if(!(n[1]instanceof O||n[1]===null))throw new i(e,s.InvalidParameter,t);if(n[0]===null||n[1]===null)return null;const r=await qn(n[0],n[1]);return r===null?null:N.convertObjectToArcadeDictionary({coordinate:r.coordinate,distance:r.distance,sideOfLine:r.distance===0?"straddle":r.isRightSide?"right":"left"},S(e),!1,!0)})})}export{De as registerFunctions};

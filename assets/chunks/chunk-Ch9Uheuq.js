import{b7 as E}from"./chunk-YzRi88Dj.js";import"./chunk-ByM7454y.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */var x={},O={},w={};Object.defineProperty(w,"__esModule",{value:!0}),w.loop=w.conditional=w.parse=void 0;var q=function t(i,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:n;if(Array.isArray(e))e.forEach(function(o){return t(i,o,n,a)});else if(typeof e=="function")e(i,n,a,t);else{var d=Object.keys(e)[0];Array.isArray(e[d])?(a[d]={},t(i,e[d],n,a[d])):a[d]=e[d](i,n,a,t)}return n};w.parse=q;var V=function(t,i){return function(e,n,a,d){i(e,n,a)&&d(e,t,n,a)}};w.conditional=V;var $=function(t,i){return function(e,n,a,d){for(var o=[],c=e.pos;i(e,n,a);){var p={};if(d(e,t,n,p),e.pos===c)break;c=e.pos,o.push(p)}return o}};w.loop=$;var l={};Object.defineProperty(l,"__esModule",{value:!0}),l.readBits=l.readArray=l.readUnsigned=l.readString=l.peekBytes=l.readBytes=l.peekByte=l.readByte=l.buildStream=void 0;var H=function(t){return{data:t,pos:0}};l.buildStream=H;var T=function(){return function(t){return t.data[t.pos++]}};l.readByte=T;var J=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return function(i){return i.data[i.pos+t]}};l.peekByte=J;var _=function(t){return function(i){return i.data.subarray(i.pos,i.pos+=t)}};l.readBytes=_;var K=function(t){return function(i){return i.data.subarray(i.pos,i.pos+t)}};l.peekBytes=K;var L=function(t){return function(i){return Array.from(_(t)(i)).map(function(e){return String.fromCharCode(e)}).join("")}};l.readString=L;var N=function(t){return function(i){var e=_(2)(i);return t?(e[1]<<8)+e[0]:(e[0]<<8)+e[1]}};l.readUnsigned=N;var Q=function(t,i){return function(e,n,a){for(var d=typeof i=="function"?i(e,n,a):i,o=_(t),c=new Array(d),p=0;p<d;p++)c[p]=o(e);return c}};l.readArray=Q;var W=function(t,i,e){for(var n=0,a=0;a<e;a++)n+=t[i+a]&&Math.pow(2,e-a-1);return n},X=function(t){return function(i){for(var e=T()(i),n=new Array(8),a=0;a<8;a++)n[7-a]=!!(e&1<<a);return Object.keys(t).reduce(function(d,o){var c=t[o];return c.length?d[o]=W(n,c.index,c.length):d[o]=n[c.index],d},{})}};l.readBits=X,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=w,e=l,n={blocks:function(r){for(var s=0,u=[],m=r.data.length,y=0,g=(0,e.readByte)()(r);g!==s&&g;g=(0,e.readByte)()(r)){if(r.pos+g>=m){var h=m-r.pos;u.push((0,e.readBytes)(h)(r)),y+=h;break}u.push((0,e.readBytes)(g)(r)),y+=g}for(var B=new Uint8Array(y),b=0,v=0;v<u.length;v++)B.set(u[v],b),b+=u[v].length;return B}},a=(0,i.conditional)({gce:[{codes:(0,e.readBytes)(2)},{byteSize:(0,e.readByte)()},{extras:(0,e.readBits)({future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},{delay:(0,e.readUnsigned)(!0)},{transparentColorIndex:(0,e.readByte)()},{terminator:(0,e.readByte)()}]},function(r){var s=(0,e.peekBytes)(2)(r);return s[0]===33&&s[1]===249}),d=(0,i.conditional)({image:[{code:(0,e.readByte)()},{descriptor:[{left:(0,e.readUnsigned)(!0)},{top:(0,e.readUnsigned)(!0)},{width:(0,e.readUnsigned)(!0)},{height:(0,e.readUnsigned)(!0)},{lct:(0,e.readBits)({exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},(0,i.conditional)({lct:(0,e.readArray)(3,function(r,s,u){return Math.pow(2,u.descriptor.lct.size+1)})},function(r,s,u){return u.descriptor.lct.exists}),{data:[{minCodeSize:(0,e.readByte)()},n]}]},function(r){return(0,e.peekByte)()(r)===44}),o=(0,i.conditional)({text:[{codes:(0,e.readBytes)(2)},{blockSize:(0,e.readByte)()},{preData:function(r,s,u){return(0,e.readBytes)(u.text.blockSize)(r)}},n]},function(r){var s=(0,e.peekBytes)(2)(r);return s[0]===33&&s[1]===1}),c=(0,i.conditional)({application:[{codes:(0,e.readBytes)(2)},{blockSize:(0,e.readByte)()},{id:function(r,s,u){return(0,e.readString)(u.blockSize)(r)}},n]},function(r){var s=(0,e.peekBytes)(2)(r);return s[0]===33&&s[1]===255}),p=(0,i.conditional)({comment:[{codes:(0,e.readBytes)(2)},n]},function(r){var s=(0,e.peekBytes)(2)(r);return s[0]===33&&s[1]===254}),f=[{header:[{signature:(0,e.readString)(3)},{version:(0,e.readString)(3)}]},{lsd:[{width:(0,e.readUnsigned)(!0)},{height:(0,e.readUnsigned)(!0)},{gct:(0,e.readBits)({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}})},{backgroundColorIndex:(0,e.readByte)()},{pixelAspectRatio:(0,e.readByte)()}]},(0,i.conditional)({gct:(0,e.readArray)(3,function(r,s){return Math.pow(2,s.lsd.gct.size+1)})},function(r,s){return s.lsd.gct.exists}),{frames:(0,i.loop)([a,c,p,d,o],function(r){var s=(0,e.peekByte)()(r);return s===33||s===44})}];t.default=f}(O);var S={};Object.defineProperty(S,"__esModule",{value:!0}),S.deinterlace=void 0;var Y=function(t,i){for(var e=new Array(t.length),n=t.length/i,a=function(r,s){var u=t.slice(s*i,(s+1)*i);e.splice.apply(e,[r*i,i].concat(u))},d=[0,4,2,1],o=[8,8,4,2],c=0,p=0;p<4;p++)for(var f=d[p];f<n;f+=o[p])a(f,c),c++;return e};S.deinterlace=Y;var z={};Object.defineProperty(z,"__esModule",{value:!0}),z.lzw=void 0;var Z=function(t,i,e){var n,a,d,o,c,p,f,r,s,u,m,y,g,h,B,b,v=4096,C=-1,j=e,F=new Array(e),M=new Array(v),k=new Array(v),A=new Array(v+1);for(c=(a=1<<(u=t))+1,n=a+2,f=C,d=(1<<(o=u+1))-1,r=0;r<a;r++)M[r]=0,k[r]=r;for(m=y=g=h=B=b=0,s=0;s<j;){if(h===0){if(y<o){m+=i[b]<<y,y+=8,b++;continue}if(r=m&d,m>>=o,y-=o,r>n||r==c)break;if(r==a){d=(1<<(o=u+1))-1,n=a+2,f=C;continue}if(f==C){A[h++]=k[r],f=r,g=r;continue}for(p=r,r==n&&(A[h++]=g,r=f);r>a;)A[h++]=k[r],r=M[r];g=255&k[r],A[h++]=g,n<v&&(M[n]=f,k[n]=g,!(++n&d)&&n<v&&(o++,d+=n)),f=p}h--,F[B++]=A[h],s++}for(s=B;s<j;s++)F[s]=0;return F};z.lzw=Z,Object.defineProperty(x,"__esModule",{value:!0});var G=x.decompressFrames=x.decompressFrame=P=x.parseGIF=void 0,ee=ae(O),te=w,re=l,ne=S,ie=z;function ae(t){return t&&t.__esModule?t:{default:t}}var oe=function(t){var i=new Uint8Array(t);return(0,te.parse)((0,re.buildStream)(i),ee.default)},P=x.parseGIF=oe,de=function(t){for(var i=t.pixels.length,e=new Uint8ClampedArray(4*i),n=0;n<i;n++){var a=4*n,d=t.pixels[n],o=t.colorTable[d]||[0,0,0];e[a]=o[0],e[a+1]=o[1],e[a+2]=o[2],e[a+3]=d!==t.transparentIndex?255:0}return e},R=function(t,i,e){if(t.image){var n=t.image,a=n.descriptor.width*n.descriptor.height,d=(0,ie.lzw)(n.data.minCodeSize,n.data.blocks,a);n.descriptor.lct.interlaced&&(d=(0,ne.deinterlace)(d,n.descriptor.width));var o={pixels:d,dims:{top:t.image.descriptor.top,left:t.image.descriptor.left,width:t.image.descriptor.width,height:t.image.descriptor.height}};return n.descriptor.lct&&n.descriptor.lct.exists?o.colorTable=n.lct:o.colorTable=i,t.gce&&(o.delay=10*(t.gce.delay||10),o.disposalType=t.gce.extras.disposal,t.gce.extras.transparentColorGiven&&(o.transparentIndex=t.gce.transparentColorIndex)),e&&(o.patch=de(o)),o}console.warn("gif frame does not have associated image.")};x.decompressFrame=R;var se=function(t,i){return t.frames.filter(function(e){return e.image}).map(function(e){return R(e,t.gct,i)})};let I,U,D;function ue(t,i){return I??=document.createElement("canvas"),I.width=t,I.height=i,I.getContext("2d",{willReadFrequently:!0})}async function Le(t,i){const e=P(t),n=G(e,!0),{width:a,height:d}=e.lsd,o=ue(a,d),c=[],p=[];let f=0;for(const r of n){const s=E(r.delay||100);p.push(s),f+=s;const u=ce(new ImageData(r.patch,r.dims.width,r.dims.height)),m=r.disposalType===3?o.getImageData(r.dims.left,r.dims.top,r.dims.width,r.dims.height):void 0;o.drawImage(u,r.dims.left,r.dims.top);const y=o.getImageData(0,0,a,d);c.push(y),r.disposalType===1||(r.disposalType===2?o.clearRect(r.dims.left,r.dims.top,r.dims.width,r.dims.height):r.disposalType===3&&o.putImageData(m,r.dims.left,r.dims.top))}return{frameCount:n.length,duration:f,frameDurations:p,getFrame:r=>c[r],width:a,height:d}}function ce(t){return U??=document.createElement("canvas"),D??=U.getContext("2d",{willReadFrequently:!0}),U.width=t.width,U.height=t.height,D.putImageData(t,0,0),U}G=x.decompressFrames=se;const pe=[71,73,70];function le(t){const i=new Uint8Array(t);return!pe.some((e,n)=>e!==i[n])}function Ne(t){if(!le(t))return!1;const i=new DataView(t),e=i.getUint8(10);let n=13+(128&e?3*2**(1+(7&e)):0),a=0,d=!1;for(;!d;){switch(i.getUint8(n++)){case 33:if(!o())return!1;break;case 44:c();break;case 59:d=!0;break;default:return!1}if(a>1)return!0}function o(){switch(i.getUint8(n++)){case 249:p();break;case 1:f();break;case 254:r();break;case 255:s();break;default:return!1}return!0}function c(){a++,n+=8;const m=i.getUint8(n++);n+=128&m?3*2**(1+(7&m)):0,n++,u()}function p(){n++,n+=4,u()}function f(){a++,n++,n+=12,u()}function r(){u()}function s(){n++,n+=8,n+=3,u()}function u(){let m;for(;m=i.getUint8(n++);)n+=m}return!1}export{Ne as isAnimatedGIF,le as isGIF,Le as parseGif};

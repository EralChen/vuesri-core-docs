import{ns as L,gZ as v,da as $,gU as u,g_ as V,oH as j,lA as F,lF as I,h8 as O,h0 as S,h9 as k,h6 as w,oF as H,hc as A,hb as C}from"./chunk-xMPjLCrx.js";import{p as T,e as q,u as B,a as M}from"./chunk-1QMMptYd.js";import{u as R}from"./chunk-J9RASU-T.js";import{a as U}from"./chunk-rQi2mmfE.js";import{_ as x,c as D}from"./chunk-gzqjvZQi.js";import{m as N}from"./chunk-xWC1_lmp.js";import{s as b}from"./chunk-B3AFDltd.js";const P={...T,source:{type:[Object,Array],required:!0,default:()=>[]},fields:{type:Array,required:!0,default:()=>[]},geometryType:{type:String,default:"point",required:!0},objectIdField:{type:String,default:"ObjectID"},forceUpdate:{type:Boolean,default:!1}},_={...q,change:e=>e,load:e=>e},ee=L(_),W=v({name:"VaClientFeatureLayer",components:{VaLayerHitEvents:x},props:P,emits:_,setup(e,{emit:i}){const n=R(),m=n.map,f=D(i),t=new $({source:e.source,...e.defaultOptions});t[b]=N();const d=t[b];return B(t,e),M(n,t,e),u(()=>{t.geometryType=e.geometryType}),u(()=>{t.objectIdField=e.objectIdField}),u(()=>{t.fields=e.fields}),U(m,t,e),V(()=>e.source,(g,E)=>{j().then(()=>{const s=[],c=g.reduce((a,r)=>{const o=r.attributes[e.objectIdField];return a[o]=r,a},{}),p=E.reduce((a,r)=>{const o=r.attributes[e.objectIdField];return Reflect.has(c,o)?(s.push(r),Reflect.deleteProperty(c,o)):a[o]=r,a},{}),y=[],h=[];for(const a in c)y.push(c[a]);for(const a in p)h.push(p[a]);return{addFeatures:y,deleteFeatures:h,updateFeatures:s}}).then(s=>t.applyEdits(s)).then(()=>(e.forceUpdate&&(t.visible=!1,t.visible=!0),{view:n,layer:t})).then(s=>{d.emit("change",s),i("change",s)})}),F("vaLayer",t),F("vaFeatureLayer",t),i("load",{view:n,layer:t}),{hitEmits:f}}});function Z(e,i,n,m,f,t){const d=O("VaLayerHitEvents");return S(),k(C,null,[w(d,H(e.hitEmits),null,16),A(e.$slots,"default")],64)}const l=I(W,[["render",Z]]);l.install=e=>{e.component(l.name,l)};export{l as V,ee as c,_ as e};

import{gO as v,gJ as m,gU as T,cX as $,q$ as b,qZ as w,gK as y,lC as g,bD as k,lz as O,lE as V,gR as p,g_ as i,lK as _,lL as B,g$ as P,h0 as h,pI as R,h1 as u}from"./chunk-CMhy9c9G.js";import{u as S}from"./chunk-Dc5RCiI0.js";const j={defaultOptions:{type:Object,default:()=>({})},title:{type:[String,Function,Promise],default:""},orphan:{type:Boolean,default:!1}},q={load:e=>e},E=v({name:"VaPopupTemplate",props:j,emits:q,setup(e,{emit:d}){const l=S(),s=m("vaSublayer",null)||m("vaLayer",null),f=s?.popupTemplate,n=T(new Map),a=new $({outFields:["*"],async content(t){const r=t.graphic.attributes;return b(t.graphic),n.value.set(t.graphic,{el:null,attributes:r}),await w(),n.value.get(t.graphic)?.el},...e.defaultOptions});y(()=>{a.title=e.title}),s&&!e.orphan&&(s.popupTemplate=a),g(()=>{s&&(s.popupTemplate=f)});const o=k(()=>l.popup.visible,t=>{t||n.value.clear()});return g(()=>{o.remove()}),d("load",{view:l,popupTemplate:a}),O("vaPopupTemplate",a),{graphicToNode:n,setRef:(t,r)=>t.el=r}}});function F(e,d,l,s,f,n){return p(),i(h,null,[_(P("div",null,[(p(!0),i(h,null,R(e.graphicToNode.entries(),([a,o])=>(p(),i("div",{key:a.getObjectId(),ref_for:!0,ref:t=>e.setRef(o,t)},[u(e.$slots,"default",{attributes:o.attributes,geometry:a.geometry,graphic:a})]))),128))],512),[[B,!1]]),u(e.$slots,"plugins"),u(e.$slots,"extends")],64)}const c=V(E,[["render",F]]);c.install=e=>{e.component(c.name,c)};export{c as V};

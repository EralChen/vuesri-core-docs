import{g$ as v,gW as m,h5 as b,d4 as T,p3 as w,p1 as y,gX as $,lJ as h,bX as k,lG as O,lL as P,h2 as r,hb as i,lR as S,lS as V,hc as B,hd as g,nO as R,he as u}from"./chunk-YzRi88Dj.js";import{u as _}from"./chunk-mQ0J7OJ8.js";const j={defaultOptions:{type:Object,default:()=>({})},title:{type:[String,Function,Promise],default:""},orphan:{type:Boolean,default:!1}},F={load:e=>e},L=v({name:"VaPopupTemplate",props:j,emits:F,setup(e,{emit:d}){const l=_(),s=m("vaSublayer",null)||m("vaLayer",null),f=s?.popupTemplate,n=b(new Map),a=new T({outFields:["*"],async content(t){const p=t.graphic.attributes;return w(t.graphic),n.value.set(t.graphic,{el:null,attributes:p}),await y(),n.value.get(t.graphic)?.el},...e.defaultOptions});$(()=>{a.title=e.title}),s&&!e.orphan&&(s.popupTemplate=a),h(()=>{s&&(s.popupTemplate=f)});const o=k(()=>l.popup.visible,t=>{t||n.value.clear()});return h(()=>{o.remove()}),d("load",{view:l,popupTemplate:a}),O("vaPopupTemplate",a),{graphicToNode:n,setRef:(t,p)=>t.el=p}}});function N(e,d,l,s,f,n){return r(),i(g,null,[S(B("div",null,[(r(!0),i(g,null,R(e.graphicToNode.entries(),([a,o])=>(r(),i("div",{key:a.getObjectId(),ref_for:!0,ref:t=>e.setRef(o,t)},[u(e.$slots,"default",{attributes:o.attributes,geometry:a.geometry,graphic:a})]))),128))],512),[[V,!1]]),u(e.$slots,"plugins"),u(e.$slots,"extends")],64)}const c=P(L,[["render",N]]);c.install=e=>{e.component(c.name,c)};export{c as V};

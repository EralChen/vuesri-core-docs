import{d8 as v,cD as w,d9 as A,b6 as T,da as h,db as L,dc as O,a_ as I,dd as P,de as q}from"./chunk-CMhy9c9G.js";function _(e,n){return f(e)===f(n)}function f(e){if(e==null)return null;const n=e.layer!=null?e.layer.id:"";let t=null;return t=e.objectId!=null?e.objectId:e.layer!=null&&"objectIdField"in e.layer&&e.layer.objectIdField!=null&&e.attributes!=null?e.attributes[e.layer.objectIdField]:e.uid,t==null?null:`o-${n}-${t}`}const k={json:{write:{writer:x,target:{"feature.layerId":{type:[Number,String]},"feature.objectId":{type:[Number,String]}}},origins:{"web-scene":{read:D}}}};function x(e,n){e?.layer?.objectIdField!=null&&e.attributes!=null&&(n.feature={layerId:e.layer.id,objectId:e.attributes[e.layer.objectIdField]})}function D(e){if(e.layerId!=null&&e.objectId!=null)return{uid:null,layer:{id:e.layerId,objectIdField:"ObjectId"},attributes:{ObjectId:e.objectId}}}function z(e,n,t,l){const{sceneIntersectionHelper:F}=e,{observer:j,observerFeatureId:c,targetFeatureId:i,target:y}=t;if(c==null&&i==null)return;l||(l=r=>r),w(a,j,y);const u=A(a),o=1;T(a,j,a,o/u);const N=h(a,y,M);n.options.store=L.ALL,F.intersectToolIntersectorRay(N,n);let m=null,g=null,s=null,d=null;for(const r of n.results.all){const S=O(r,e);if(S==null||r.distanceInRenderSpace==null)continue;const b=f(S);b!=null&&(c!=null&&b===c&&(m??=l(p(r,e,u)),r.distanceInRenderSpace-o<m&&(s=r)),i!=null&&b===i&&(g??=l(p(r,e,u)),d==null&&r.distanceInRenderSpace-o<u&&u-r.distanceInRenderSpace+o<g&&(d=r)))}const{observerAdjusted:$,targetAdjusted:R}=t;s?.getIntersectionPoint($)?t.observerSurfaceNormal=s.getTransformedNormal(I()):t.observerSurfaceNormal=null,d?.getIntersectionPoint(R)?t.targetSurfaceNormal=d.getTransformedNormal(I()):t.targetSurfaceNormal=null}function p(e,n,t){if(P(e)){const l=q(e,n);if(l!=null)return Math.min(l*H,t)}return 1e-5*t}const H=.05,M=v(),a=I();export{k as b,_ as c,f as d,z as m};

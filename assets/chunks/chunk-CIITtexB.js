import{dL as D,cE as U,cF as V,cG as z,cH as j,dM as W,dN as q,d1 as b,cL as w,d6 as A,dO as u,dP as F,dQ as l,dR as I,dS as E,dT as $,dU as L,dV as M,dW as S,dX as y,s as G,cI as N,U as O,dY as T,dZ as P,A as R,d_ as X,a1 as h,a2 as f,d$ as k,cO as K,a4 as Z,aq as H,bq as g}from"./chunk-YzRi88Dj.js";import"./chunk-ByM7454y.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */let m=class extends D(U(V(z(j(W(q(H))))))){constructor(i){super(i),this.operationalLayerType="IntegratedMesh3DTilesLayer",this.spatialReference=new b({wkid:4326,vcsWkid:115700}),this.fullExtent=new w(-180,-90,180,90,this.spatialReference),this.url=null,this.type="integrated-mesh-3dtiles",this.path=null,this.minScale=0,this.maxScale=0}set elevationInfo(i){this._set("elevationInfo",i),this._validateElevationInfo()}_verifyArray(i,r){if(!Array.isArray(i)||i.length<r)return!1;for(const n of i)if(typeof n!="number")return!1;return!0}_initFullExtent(i){const r=i.root?.boundingVolume;if(!r)return;if(r.box){const t=r?.box;if(t[3]>7972671&&t[7]>7972671&&t[11]>7945940)return}const n=i.root?.transform,x=g();if(r.region&&this._verifyArray(r.region,6)){const t=r.region,p=A(t[0]),s=A(t[1]),a=t[4],o=A(t[2]),e=A(t[3]),d=t[5];this.fullExtent=new w({xmin:p,ymin:s,zmin:a,xmax:o,ymax:e,zmax:d,spatialReference:this.spatialReference})}else if(r.sphere&&this._verifyArray(r.sphere,4)){const t=r.sphere,p=u(t[0],t[1],t[2]),s=t[3]/Math.sqrt(3),a=g();F(a,p,u(-s,-s,-s));const o=g();if(l(o,p,u(s,s,s)),n&&this._verifyArray(n,16)){const v=n;I(x,a,v),E(a,x),I(x,o,v),E(o,x)}$(a,L,0,a,b.WGS84,0,1),$(o,L,0,o,b.WGS84,0,1);const e=g(),d=g();M(e,a,o),S(d,a,o),this.fullExtent=new w({xmin:e[0],ymin:e[1],zmin:e[2],xmax:d[0],ymax:d[1],zmax:d[2],spatialReference:this.spatialReference})}else if(r.box&&this._verifyArray(r.box,12)){const t=r.box,p=u(t[0],t[1],t[2]),s=u(t[3],t[4],t[5]),a=u(t[6],t[7],t[8]),o=u(t[9],t[10],t[11]),e=[];for(let c=0;c<8;++c)e.push(g());if(l(e[0],p,s),l(e[0],e[0],a),l(e[0],e[0],o),y(e[1],p,s),l(e[1],e[1],a),l(e[1],e[1],o),l(e[2],p,s),y(e[2],e[2],a),l(e[2],e[2],o),y(e[3],p,s),y(e[3],e[3],a),l(e[3],e[3],o),l(e[4],p,s),l(e[4],e[4],a),y(e[4],e[4],o),y(e[5],p,s),l(e[5],e[5],a),y(e[5],e[5],o),l(e[6],p,s),y(e[6],e[6],a),y(e[6],e[6],o),y(e[7],p,s),y(e[7],e[7],a),y(e[7],e[7],o),n&&this._verifyArray(n,16)){const c=n;for(let _=0;_<8;++_)I(e[_],e[_],c)}const d=u(Number.MIN_VALUE,Number.MIN_VALUE,Number.MIN_VALUE),v=u(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);for(let c=0;c<8;++c)$(e[c],L,0,e[c],b.WGS84,0,1),M(v,v,e[c]),S(d,d,e[c]);this.fullExtent=new w({xmin:v[0],ymin:v[1],zmin:v[2],xmax:d[0],ymax:d[1],zmax:d[2],spatialReference:this.spatialReference})}}async load(i){return this.addResolvingPromise(this._doLoad(i)),this}async _doLoad(i){const r=i!=null?i.signal:null;try{await this.loadFromPortal({supportedTypes:["3DTiles Service"],validateItem:n=>{if(n.typeKeywords?.includes("IntegratedMesh"))return!0;throw new G("portal:invalid-layer-item-type","Invalid layer item, expected '${expectedType}' ",{expectedType:"3DTiles Service containing IntegratedMesh"})}},i)}catch(n){N(n)}this.url&&await O(this.url,{query:{f:"json",...this.customParameters,token:this.apiKey},responseType:"json",signal:r}).then(x=>{this._initFullExtent(x.data)},x=>{N(x)})}async fetchAttributionData(){return this.load().then(()=>({}))}_validateElevationInfo(){const i=this.elevationInfo,r="Integrated mesh 3d tiles layers";T(R.getLogger(this),P(r,"absolute-height",i)),T(R.getLogger(this),X(r,i))}};h([f({type:["IntegratedMesh3DTilesLayer"]})],m.prototype,"operationalLayerType",void 0),h([f({type:b})],m.prototype,"spatialReference",void 0),h([f({type:w})],m.prototype,"fullExtent",void 0),h([f(k)],m.prototype,"elevationInfo",null),h([f({type:["show","hide"]})],m.prototype,"listMode",void 0),h([f(K)],m.prototype,"url",void 0),h([f({readOnly:!0})],m.prototype,"type",void 0),h([f({type:String,json:{origins:{"web-scene":{read:!0,write:!0},"portal-item":{read:!0,write:!0}},read:!1}})],m.prototype,"path",void 0),h([f({type:Number,json:{origins:{"web-scene":{name:"layerDefinition.minScale",write:()=>{},read:()=>{}},"portal-item":{name:"layerDefinition.minScale",write:()=>{},read:()=>{}}}}})],m.prototype,"minScale",void 0),h([f({type:Number,json:{origins:{"web-scene":{name:"layerDefinition.maxScale",write:()=>{},read:()=>{}},"portal-item":{name:"layerDefinition.maxScale",write:()=>{},read:()=>{}}}}})],m.prototype,"maxScale",void 0),m=h([Z("esri.layers.IntegratedMesh3DTilesLayer")],m);const Se=m;export{Se as default};

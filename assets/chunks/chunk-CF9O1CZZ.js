import{fz as h,bZ as u,V as c,eE as y,bX as f,am as g,A as w,fH as V,a1 as v,a4 as C}from"./chunk-CGsGeN7j.js";import"./chunk-ByM7454y.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */const a=Symbol();let p=class extends h(u){constructor(){super(...arguments),this.layerViews=new c,this._debouncedUpdate=y(async()=>{const{layer:e,parent:{footprintLayerView:i}}=this;let r=[];if(i){const s=this._createQuery(),{features:o}=await i.queryFeatures(s);this.suspended||(r=o.map(d=>e.acquireLayer(d)))}this.removeHandles(a),this.addHandles(r,a)})}attach(){this.addAttachHandles([this._updatingHandles.addOnCollectionChange(()=>this.layerViews,()=>this._updateStageChildren(),{initial:!0}),f(()=>this.parent.footprintLayerView?.dataUpdating===!1,()=>this._updateLayers()),g(()=>[this.layer.maximumVisibleSublayers,this.suspended,this.parent.footprintLayerView?.filter],()=>this._updateLayers())])}detach(){this.container.removeAllChildren(),this.removeHandles(a)}update(e){}moveStart(){}viewChange(){}moveEnd(){}isUpdating(){return this.layerViews.some(e=>e.updating)}_updateStageChildren(){this.container.removeAllChildren(),this.layerViews.forEach((e,i)=>this.container.addChildAt(e.container,i))}_updateLayers(){this.suspended?this.removeHandles(a):this._updatingHandles.addPromise(this._debouncedUpdate().catch(e=>{w.getLogger(this).error(e)}))}_createQuery(){const{parent:{footprintLayerView:e},layer:{maximumVisibleSublayers:i,parent:{itemTypeField:r,itemSourceField:s,objectIdField:o,orderBy:d}}}=this,l=`${r} <> 'Scene Service'`,t=e.createQuery();t.returnGeometry=!1,t.num=i,t.outFields=[o,s],t.where=V(t.where,l);const n=d?.find(m=>m.field&&!m.valueExpression);return n?.field&&(t.orderByFields=[`${n.field} ${n.order==="descending"?"DESC":"ASC"}`]),t}};p=v([C("esri.views.2d.layers.CatalogDynamicGroupLayerView2D")],p);const ie=p;export{ie as default};

import{p as x,H as C,X as E,h as g,a as A}from"./chunk-CMhy9c9G.js";import{t as S,e as M,n as p}from"./chunk-CsMSDKC5.js";import"./chunk-ByM7454y.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
 * v2.13.2
 */function y(a){return a?.tagName==="CALCITE-TREE-ITEM"}function w(a){return Array.from(a.querySelectorAll("calcite-tree-item:not([disabled])")).filter(e=>{let i=e;for(;i!==a&&i!==void 0;){const s=i.parentElement;if(!(!y(s)||!s.hasChildren||s.expanded))return!1;i=i.parentElement}return!0})}const D=":host{display:block}:host(:focus){outline:2px solid transparent;outline-offset:2px}:host([hidden]){display:none}[hidden]{display:none}",k=D,T=x(class extends C{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.calciteTreeSelect=E(this,"calciteTreeSelect",6),this.keyDownHandler=e=>{if(this.child)return;const i=this.el,s=e.target,o=["ArrowRight","ArrowDown","ArrowLeft","ArrowUp","Home","End","Tab"];if(!(y(s)&&this.el.contains(s))||!o.includes(e.key))return;const r=w(i);if(e.key==="Tab"){r.forEach(l=>l.tabIndex=-1);return}if(e.key==="ArrowDown"){const l=r.indexOf(s);r[l+1]?.focus(),e.preventDefault();return}if(e.key==="ArrowUp"){const l=r.indexOf(s);r[l-1]?.focus(),e.preventDefault();return}if(e.key==="ArrowLeft"){if(s.hasChildren&&s.expanded){s.expanded=!1,e.preventDefault();return}r.slice(0,r.indexOf(s)).reverse().find(u=>u.depth===s.depth-1)?.focus(),e.preventDefault();return}if(e.key==="ArrowRight"){if(!s.disabled&&s.hasChildren)if(!s.expanded)s.expanded=!0,e.preventDefault();else{const l=r.indexOf(s);r[l+1]?.focus(),e.preventDefault()}return}if(e.key==="Home"){const l=r.shift();l&&(l.focus(),e.preventDefault());return}if(e.key==="End"){const l=r.pop();l&&(l.focus(),e.preventDefault());return}},this.lines=!1,this.child=void 0,this.scale="m",this.selectionMode="single",this.selectedItems=[]}componentWillRender(){const e=this.el.parentElement?.closest("calcite-tree");this.lines=e?e.lines:this.lines,this.scale=e?e.scale:this.scale,this.selectionMode=e?e.selectionMode:this.selectionMode,this.child=!!e}render(){return g(A,{key:"5b08de1c59622b78985de9019bf4ba11d605a07f","aria-multiselectable":this.child?void 0:S(this.selectionMode==="multiple"||this.selectionMode==="multichildren"),onKeyDown:this.keyDownHandler,role:this.child?void 0:"tree",tabIndex:this.getRootTabIndex()},g("slot",{key:"00a037cf92cb5facadc4b2961a9369b6ae0631f5"}))}onFocus(){if(!this.child){const e=this.el.querySelector("calcite-tree-item[selected]:not([disabled])")||this.el.querySelector("calcite-tree-item:not([disabled])");M(e)}}onFocusIn(e){(e.relatedTarget===this.el||!this.el.contains(e.relatedTarget))&&this.el.removeAttribute("tabindex")}onFocusOut(e){!this.el.contains(e.relatedTarget)&&(this.el.tabIndex=this.getRootTabIndex())}onInternalTreeItemSelect(e){if(this.child)return;const i=e.target,s=p(i.querySelectorAll("calcite-tree-item"));if(e.preventDefault(),e.stopPropagation(),this.selectionMode==="ancestors"){this.updateAncestorTree(e);return}const o=this.selectionMode==="none",r=this.selectionMode!==null&&(!i.hasChildren||i.hasChildren&&(this.selectionMode==="children"||this.selectionMode==="multichildren")),l=this.selectionMode==="multichildren"&&i.hasChildren,c=!o&&e.detail.modifyCurrentSelection&&(this.selectionMode==="multiple"||this.selectionMode==="multichildren"),u=!c&&((this.selectionMode==="single"||this.selectionMode==="multiple")&&s.length<=0||this.selectionMode==="children"||this.selectionMode==="multichildren"||this.selectionMode==="single-persist"&&!i.hasChildren),h=["multiple","none","single","single-persist"].includes(this.selectionMode)&&i.hasChildren,d=[];r&&d.push(i),u&&p(this.el.querySelectorAll("calcite-tree-item[selected]")).forEach(n=>{d.includes(n)||(n.selected=!1)}),h&&["multiple","none","single","single-persist"].includes(this.selectionMode)&&(i.expanded=!i.expanded),l&&s.forEach(t=>{t.selected=!1,t.hasChildren&&(t.expanded=!1)}),c&&window.getSelection().removeAllRanges(),c&&i.selected?d.forEach(t=>{t.disabled||(t.selected=!1)}):o||d.forEach(t=>{t.disabled||(t.selected=this.selectionMode!=="single"||!t.selected)}),this.selectedItems=o?[]:p(this.el.querySelectorAll("calcite-tree-item")).filter(t=>t.selected),this.calciteTreeSelect.emit(),e.stopPropagation()}updateAncestorTree(e){const i=e.target,s=e.detail.updateItem;if(i.disabled||i.indeterminate&&!s)return;const o=[];let r=i.parentElement.closest("calcite-tree-item");for(;r;)o.push(r),r=r.parentElement.closest("calcite-tree-item");const l=Array.from(i.querySelectorAll("calcite-tree-item:not([disabled])")),c=l.filter(t=>!t.hasChildren),u=l.filter(t=>t.hasChildren);let h;s?h=i.hasChildren?!(i.selected||i.indeterminate):!i.selected:h=i.selected,c.forEach(t=>{t.selected=h,t.indeterminate=!1});function d(t,n){const m=t.filter(f=>f.selected),I=t.filter(f=>!f.selected);n.selected=m.length===t.length,n.indeterminate=m.length>0&&I.length>0}u.reverse().forEach(t=>{const n=Array.from(t.querySelectorAll(":scope > calcite-tree > calcite-tree-item"));d(n,t)}),s&&(i.hasChildren?d(l,i):(i.selected=h,i.indeterminate=!1)),o.forEach(t=>{const n=p(t.querySelectorAll("calcite-tree-item")),m=n.filter(f=>f.selected);if(m.length===0){t.selected=!1,t.indeterminate=!1;return}const I=m.length<n.length;t.indeterminate=I,t.selected=!I}),this.selectedItems=p(this.el.querySelectorAll("calcite-tree-item")).filter(t=>t.selected),s&&this.calciteTreeSelect.emit()}getRootTabIndex(){return this.child?-1:0}get el(){return this}static get style(){return k}},[1,"calcite-tree",{lines:[1540],child:[1540],scale:[1537],selectionMode:[1537,"selection-mode"],selectedItems:[1040]},[[0,"focus","onFocus"],[0,"focusin","onFocusIn"],[0,"focusout","onFocusOut"],[0,"calciteInternalTreeItemSelect","onInternalTreeItemSelect"]]]);function b(){if(typeof customElements>"u")return;["calcite-tree"].forEach(e=>{switch(e){case"calcite-tree":customElements.get(e)||customElements.define(e,T);break}})}b();const ue=T,me=b;export{ue as CalciteTree,me as defineCustomElement};

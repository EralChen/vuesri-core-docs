import{gZ as v,gT as m,h3 as T,d2 as b,oJ as w,oI as y,gU as $,lF as h,bH as k,lC as P,lH as V,h0 as p,h9 as i,lN as B,lM as F,ha as N,hb as g,oK as O,hc as u}from"./chunk-fHrNL0KE.js";import{u as S}from"./chunk-oihAJXyJ.js";const _={defaultOptions:{type:Object,default:()=>({})},title:{type:[String,Function,Promise],default:""},orphan:{type:Boolean,default:!1}},j={load:e=>e},R=v({name:"VaPopupTemplate",props:_,emits:j,setup(e,{emit:d}){const l=S(),s=m("vaSublayer",null)||m("vaLayer",null),f=s?.popupTemplate,o=T(new Map),a=new b({outFields:["*"],async content(t){const r=t.graphic.attributes;return w(t.graphic),o.value.set(t.graphic,{el:null,attributes:r}),await y(),o.value.get(t.graphic)?.el},...e.defaultOptions});$(()=>{a.title=e.title}),s&&!e.orphan&&(s.popupTemplate=a),h(()=>{s&&(s.popupTemplate=f)});const n=k(()=>l.popup.visible,t=>{t||o.value.clear()});return h(()=>{n.remove()}),d("load",{view:l,popupTemplate:a}),P("vaPopupTemplate",a),{graphicToNode:o,setRef:(t,r)=>t.el=r}}});function C(e,d,l,s,f,o){return p(),i(g,null,[B(N("div",null,[(p(!0),i(g,null,O(e.graphicToNode.entries(),([a,n])=>(p(),i("div",{key:a.getObjectId(),ref_for:!0,ref:t=>e.setRef(n,t)},[u(e.$slots,"default",{attributes:n.attributes,geometry:a.geometry,graphic:a})]))),128))],512),[[F,!1]]),u(e.$slots,"plugins"),u(e.$slots,"extends")],64)}const c=V(R,[["render",C]]);c.install=e=>{e.component(c.name,c)};export{c as V};

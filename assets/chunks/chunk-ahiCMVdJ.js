import{u as U}from"./chunk-iptrbIQE.js";import{u as b}from"./chunk-mRebXws9.js";import{gY as g,U as h,lB as S,gU as T,gV as k,lD as v,hb as I}from"./chunk-VRza80L0.js";import{s as L}from"./chunk-B3AFDltd.js";import{c as M}from"./chunk-WgvbwtiK.js";const w={extras:{type:Array,default:()=>[]}},A={click:e=>e},C=g({name:"VaWmsLayerOnClick",props:w,emits:A,setup(e,{emit:c}){const t=U(),n=b(),i=t[L],l=M(i),a=new l("click",async m=>{const{event:u}=m,d=n.sublayers.filter(s=>s.visible&&s.queryable&&s.name).map(({name:s})=>s);d.push(...e.extras);const r=d.join(),{xmin:f,ymin:y,xmax:x,ymax:E,spatialReference:{wkid:$}}=t.extent,R=`${f},${y},${x},${E}`,_=`EPSG:${$}`;let p;r&&(p=await h(n.featureInfoUrl,{query:{SERVICE:"WMS",LAYERS:r,QUERY_LAYERS:r,REQUEST:"GetFeatureInfo",INFO_FORMAT:"application/json",FEATURE_COUNT:5,BBOX:R,CRS:_,WIDTH:t.width,HEIGHT:t.height,I:Math.round(u.x),J:Math.round(u.y)}})),c("click",{...m,requestResponse:p})});return a.add(),S(()=>{a.remove()}),T(()=>{a.remove()}),k(()=>{a.add()}),{}}});function H(e,c,t,n,i,l){return I(e.$slots,"default")}const o=v(C,[["render",H]]);o.install=e=>{e.component(o.name,o)};export{o as V};

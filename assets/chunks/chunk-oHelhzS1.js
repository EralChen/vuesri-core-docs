const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chunks/chunk-BQDlTnPf.js","assets/chunks/chunk-ByM7454y.js","assets/chunks/chunk-CGsGeN7j.js","assets/static/ShadedColorMaterial.B02UECUJ.css","assets/static/uno-ff4db1d1.D2PgLIQl.css","assets/static/src_styles_common_reset-f7a68b0e.BAKp5MHC.css","assets/static/src_styles_common_color-a7a524c7.CVau4Kly.css","assets/static/src_styles_common_is-19c6c24d.DKAKruk7.css","assets/static/style-57df08cc.D7BtIwaj.css","assets/static/style-700e5873.Beul3IQx.css","assets/static/src_styles_element-plus_reset-752cc03d.htEpr2M-.css","assets/static/src_styles_element-plus_form-item-877afd6a.Dy4HJB2K.css","assets/static/src_styles_element-plus_table-6cbc5816.DXG1SsxY.css","assets/static/src_styles_element-plus_tabs-67d1a98b.BMDMQPDv.css","assets/static/src_styles_element-plus_tree-cc28503d.nmT5n0wM.css","assets/static/src_styles_element-plus_dialog-7f91a00e.D4nTsJge.css","assets/static/src_styles_element-plus_breadcrumb-8ce3a1a1.CwEEGJYc.css","assets/static/src_styles_element-plus_menu-33b44202.hFAFO4eV.css","assets/static/style-a19f1b3e.COrvIKje.css","assets/static/style-ea2b3f9e.BxAlKMJv.css","assets/static/style-283bc4f4.Cc2PI5FU.css","assets/static/style-58ae5ce4.ZkyQBZjt.css","assets/static/src_styles_form_sub-7371c85e.y3zh-mS3.css","assets/static/src_styles_layout_index-2891f17b.BNCqvENj.css","assets/static/style-b3fe97a2.BuWAVw4m.css","assets/static/src_styles_vitepress_demo-827dc91c.Z0iQYynG.css","assets/static/style-0c254f43.BgXNzrGH.css","assets/static/style-d5a1a87d.BZwgKm1s.css","assets/static/style-f69381ee.CFNWXuiE.css","assets/static/style-b895e1ce.X9gIGpBH.css","assets/static/style-44d656df.Di2LGzYR.css","assets/static/style-fbf2e11d.CdbrDi0S.css","assets/static/src_styles_markdown_reset-fbd16bdd.D3vNaEcf.css","assets/static/src_layouts_default_aside-6ea01de8.BjbON5Ij.css","assets/static/vitepress_components_VPDocOutlineItem-4ff7b581.ADPwdkw3.css","assets/static/vitepress_components_VPDocAsideOutline-9eba9441.2-W4eQLy.css"])))=>i.map(i=>d[i]);
import{_ as b}from"./chunk-ByM7454y.js";import{j as I,s as d,N as h,P as L,W as O,X as P,e as g,Y as v}from"./chunk-CGsGeN7j.js";import{t as T}from"./chunk-Ckdf8AEO.js";import{t as m}from"./chunk-D73HSFae.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */const U={FeatureLayer:!0,SceneLayer:!0};async function we(r){const s=r.properties?.customParameters,e=await _(r.url,s),a={...r.properties,url:r.url};if(e.layers.length+e.tables.length===0)return e.layerId!=null&&(a.layerId=e.layerId),e.sourceJSON!=null&&(a.sourceJSON=e.sourceJSON),new e.Constructor(a);const o=new(await b(async()=>{const{default:t}=await import("./chunk-BQDlTnPf.js");return{default:t}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35]))).default({title:e.parsedUrl.title});return await F(o,e,a),o}function w(r,s){return r?r.find(e=>e.id===s):null}async function F(r,s,e){function a(t,l,c,i){const u={...e,layerId:l,sublayerTitleMode:"service-name"};return t!=null&&(u.url=t),c!=null&&(u.sourceJSON=c),i(u)}const o=s.sublayerConstructorProvider;for(const{id:t,serverUrl:l}of s.layers){const c=w(s.sublayerInfos,t),i=(c&&o?.(c))??s.Constructor,u=a(l,t,c,n=>new i(n));r.add(u)}if(s.tables.length){const t=await f("FeatureLayer");s.tables.forEach(({id:l,serverUrl:c})=>{const i=a(c,l,w(s.tableInfos,l),u=>new t(u));r.tables.add(i)})}}async function _(r,s){let e=I(r);if(e==null&&(e=await $(r,s)),e==null)throw new d("arcgis-layers:url-mismatch","The url '${url}' is not a valid arcgis resource",{url:r});const{serverType:a,sublayer:o}=e;let t;const l={FeatureServer:"FeatureLayer",StreamServer:"StreamLayer",VectorTileServer:"VectorTileLayer"},c=a==="FeatureServer",i=a==="SceneServer",u={parsedUrl:e,Constructor:null,layerId:c||i?o??void 0:void 0,layers:[],tables:[]};switch(a){case"MapServer":o!=null?t="FeatureLayer":t=await J(r,s)?"TileLayer":"MapImageLayer";break;case"ImageServer":{const n=await m(r,{customParameters:s}),{tileInfo:y,cacheType:p}=n;t=y?y?.format?.toUpperCase()!=="LERC"||p&&p.toLowerCase()!=="elevation"?"ImageryTileLayer":"ElevationLayer":"ImageryLayer";break}case"SceneServer":{const n=await m(e.url.path,{customParameters:s});if(t="SceneLayer",n){const y=n?.layers;if(n?.layerType==="Voxel")t="VoxelLayer";else if(y?.length){const p=y[0]?.layerType;p!=null&&v[p]!=null&&(t=v[p])}}break}case"3DTilesServer":throw new d("arcgis-layers:unsupported","fromUrl() not supported for 3DTiles layers");case"FeatureServer":if(t="FeatureLayer",o!=null){const n=await m(r,{customParameters:s});u.sourceJSON=n,n.type==="Oriented Imagery Layer"&&(t="OrientedImageryLayer")}break;default:t=l[a]}if(U[t]&&o==null){const n=await C(r,a,s);if(c&&(u.sublayerInfos=n.layerInfos,u.tableInfos=n.tableInfos),n.layers.length+n.tables.length!==1)u.layers=n.layers,u.tables=n.tables,c&&n.layerInfos?.length&&(u.sublayerConstructorProvider=await E(n.layerInfos));else if(c||i){const y=n.layerInfos?.[0]??n.tableInfos?.[0];u.layerId=n.layers[0]?.id??n.tables[0]?.id,u.sourceJSON=y,c&&y?.type==="Oriented Imagery Layer"&&(t="OrientedImageryLayer")}}return u.Constructor=await f(t),u}async function $(r,s){const e=await m(r,{customParameters:s});let a=null,o=null;const t=e.type;if(t==="Feature Layer"||t==="Table"?(a="FeatureServer",o=e.id??null):t==="indexedVector"?a="VectorTileServer":e.hasOwnProperty("mapName")?a="MapServer":e.hasOwnProperty("bandCount")&&e.hasOwnProperty("pixelSizeX")?a="ImageServer":e.hasOwnProperty("maxRecordCount")&&e.hasOwnProperty("allowGeometryUpdates")?a="FeatureServer":e.hasOwnProperty("streamUrls")?a="StreamServer":S(e)?(a="SceneServer",o=e.id):e.hasOwnProperty("layers")&&S(e.layers?.[0])&&(a="SceneServer"),!a)return null;const l=o!=null?h(r):null;return{title:l!=null&&e.name||L(r),serverType:a,sublayer:o,url:{path:l!=null?l.serviceUrl:O(r).path}}}function S(r){return r!=null&&r.hasOwnProperty("store")&&r.hasOwnProperty("id")&&typeof r.id=="number"}async function C(r,s,e){let a,o,t=!1;switch(s){case"FeatureServer":{const i=await T(r,{customParameters:e});t=!!i.layersJSON,a=i.layersJSON||i.serviceJSON;break}case"SceneServer":{const i=await N(r,e);a=i.serviceInfo,o=i.tableServerUrl;break}default:a=await m(r,{customParameters:e})}const l=a?.layers,c=a?.tables;return{layers:l?.map(i=>({id:i.id})).reverse()||[],tables:c?.map(i=>({serverUrl:o,id:i.id})).reverse()||[],layerInfos:t?l:[],tableInfos:t?c:[]}}async function N(r,s){const e=await m(r,{customParameters:s});if(!e.layers?.[0])return{serviceInfo:e};try{const{serverUrl:o}=await P(r),t=await m(o,{customParameters:s}).catch(()=>null);return t&&(e.tables=t.tables),{serviceInfo:e,tableServerUrl:o}}catch{return{serviceInfo:e}}}async function f(r){return(0,g[r])()}async function J(r,s){return(await m(r,{customParameters:s})).tileInfo}async function E(r){const s=[],e=[];if(r.forEach(t=>{const{type:l}=t;l==="Oriented Imagery Layer"?(s.push(l),e.push(f("OrientedImageryLayer"))):(s.push(l),e.push(f("FeatureLayer")))}),!e.length)return;const a=await Promise.all(e),o=new Map;return s.forEach((t,l)=>{o.set(t,a[l])}),t=>o.get(t.type)}export{we as fromUrl};

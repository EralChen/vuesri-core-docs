import{fU as J}from"./chunk-CMhy9c9G.js";import"./chunk-ByM7454y.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */var D,x={},G={},B={};function $(){if(D)return B;D=1,Object.defineProperty(B,"__esModule",{value:!0}),B.loop=B.conditional=B.parse=void 0;var m=function i(d,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:s;if(Array.isArray(o))o.forEach(function(y){return i(d,y,s,c)});else if(typeof o=="function")o(d,s,c,i);else{var p=Object.keys(o)[0];Array.isArray(o[p])?(c[p]={},i(d,o[p],s,c[p])):c[p]=o[p](d,s,c,i)}return s};B.parse=m;var u=function(i,d){return function(o,s,c,p){d(o,s,c)&&p(o,i,s,c)}};B.conditional=u;var t=function(i,d){return function(o,s,c,p){for(var y=[],e=o.pos;d(o,s,c);){var r={};if(p(o,i,s,r),o.pos===e)break;e=o.pos,y.push(r)}return y}};return B.loop=t,B}var O,T,h={};function H(){if(O)return h;O=1,Object.defineProperty(h,"__esModule",{value:!0}),h.readBits=h.readArray=h.readUnsigned=h.readString=h.peekBytes=h.readBytes=h.peekByte=h.readByte=h.buildStream=void 0;var m=function(e){return{data:e,pos:0}};h.buildStream=m;var u=function(){return function(e){return e.data[e.pos++]}};h.readByte=u;var t=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return function(r){return r.data[r.pos+e]}};h.peekByte=t;var i=function(e){return function(r){return r.data.subarray(r.pos,r.pos+=e)}};h.readBytes=i;var d=function(e){return function(r){return r.data.subarray(r.pos,r.pos+e)}};h.peekBytes=d;var o=function(e){return function(r){return Array.from(i(e)(r)).map(function(n){return String.fromCharCode(n)}).join("")}};h.readString=o;var s=function(e){return function(r){var n=i(2)(r);return e?(n[1]<<8)+n[0]:(n[0]<<8)+n[1]}};h.readUnsigned=s;var c=function(e,r){return function(n,a,f){for(var g=typeof r=="function"?r(n,a,f):r,l=i(e),v=new Array(g),w=0;w<g;w++)v[w]=l(n);return v}};h.readArray=c;var p=function(e,r,n){for(var a=0,f=0;f<n;f++)a+=e[r+f]&&Math.pow(2,n-f-1);return a},y=function(e){return function(r){for(var n=u()(r),a=new Array(8),f=0;f<8;f++)a[7-f]=!!(n&1<<f);return Object.keys(e).reduce(function(g,l){var v=e[l];return v.length?g[l]=p(a,v.index,v.length):g[l]=a[v.index],g},{})}};return h.readBits=y,h}function K(){return T||(T=1,function(m){Object.defineProperty(m,"__esModule",{value:!0}),m.default=void 0;var u=$(),t=H(),i={blocks:function(e){for(var r=0,n=[],a=e.data.length,f=0,g=(0,t.readByte)()(e);g!==r&&g;g=(0,t.readByte)()(e)){if(e.pos+g>=a){var l=a-e.pos;n.push((0,t.readBytes)(l)(e)),f+=l;break}n.push((0,t.readBytes)(g)(e)),f+=g}for(var v=new Uint8Array(f),w=0,b=0;b<n.length;b++)v.set(n[b],w),w+=n[b].length;return v}},d=(0,u.conditional)({gce:[{codes:(0,t.readBytes)(2)},{byteSize:(0,t.readByte)()},{extras:(0,t.readBits)({future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},{delay:(0,t.readUnsigned)(!0)},{transparentColorIndex:(0,t.readByte)()},{terminator:(0,t.readByte)()}]},function(e){var r=(0,t.peekBytes)(2)(e);return r[0]===33&&r[1]===249}),o=(0,u.conditional)({image:[{code:(0,t.readByte)()},{descriptor:[{left:(0,t.readUnsigned)(!0)},{top:(0,t.readUnsigned)(!0)},{width:(0,t.readUnsigned)(!0)},{height:(0,t.readUnsigned)(!0)},{lct:(0,t.readBits)({exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},(0,u.conditional)({lct:(0,t.readArray)(3,function(e,r,n){return Math.pow(2,n.descriptor.lct.size+1)})},function(e,r,n){return n.descriptor.lct.exists}),{data:[{minCodeSize:(0,t.readByte)()},i]}]},function(e){return(0,t.peekByte)()(e)===44}),s=(0,u.conditional)({text:[{codes:(0,t.readBytes)(2)},{blockSize:(0,t.readByte)()},{preData:function(e,r,n){return(0,t.readBytes)(n.text.blockSize)(e)}},i]},function(e){var r=(0,t.peekBytes)(2)(e);return r[0]===33&&r[1]===1}),c=(0,u.conditional)({application:[{codes:(0,t.readBytes)(2)},{blockSize:(0,t.readByte)()},{id:function(e,r,n){return(0,t.readString)(n.blockSize)(e)}},i]},function(e){var r=(0,t.peekBytes)(2)(e);return r[0]===33&&r[1]===255}),p=(0,u.conditional)({comment:[{codes:(0,t.readBytes)(2)},i]},function(e){var r=(0,t.peekBytes)(2)(e);return r[0]===33&&r[1]===254}),y=[{header:[{signature:(0,t.readString)(3)},{version:(0,t.readString)(3)}]},{lsd:[{width:(0,t.readUnsigned)(!0)},{height:(0,t.readUnsigned)(!0)},{gct:(0,t.readBits)({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}})},{backgroundColorIndex:(0,t.readByte)()},{pixelAspectRatio:(0,t.readByte)()}]},(0,u.conditional)({gct:(0,t.readArray)(3,function(e,r){return Math.pow(2,r.lsd.gct.size+1)})},function(e,r){return r.lsd.gct.exists}),{frames:(0,u.loop)([d,c,p,o,s],function(e){var r=(0,t.peekByte)()(e);return r===33||r===44})}];m.default=y}(G)),G}var P,I={};function L(){if(P)return I;P=1,Object.defineProperty(I,"__esModule",{value:!0}),I.deinterlace=void 0;var m=function(u,t){for(var i=new Array(u.length),d=u.length/t,o=function(r,n){var a=u.slice(n*t,(n+1)*t);i.splice.apply(i,[r*t,t].concat(a))},s=[0,4,2,1],c=[8,8,4,2],p=0,y=0;y<4;y++)for(var e=s[y];e<d;e+=c[y])o(e,p),p++;return i};return I.deinterlace=m,I}var R,E,S={};function N(){if(R)return S;R=1,Object.defineProperty(S,"__esModule",{value:!0}),S.lzw=void 0;var m=function(u,t,i){var d,o,s,c,p,y,e,r,n,a,f,g,l,v,w,b,k=4096,C=-1,j=i,F=new Array(i),M=new Array(k),A=new Array(k),U=new Array(k+1);for(p=(o=1<<(a=u))+1,d=o+2,e=C,s=(1<<(c=a+1))-1,r=0;r<o;r++)M[r]=0,A[r]=r;for(f=g=l=v=w=b=0,n=0;n<j;){if(v===0){if(g<c){f+=t[b]<<g,g+=8,b++;continue}if(r=f&s,f>>=c,g-=c,r>d||r==p)break;if(r==o){s=(1<<(c=a+1))-1,d=o+2,e=C;continue}if(e==C){U[v++]=A[r],e=r,l=r;continue}for(y=r,r==d&&(U[v++]=l,r=e);r>o;)U[v++]=A[r],r=M[r];l=255&A[r],U[v++]=l,d<k&&(M[d]=e,A[d]=l,!(++d&s)&&d<k&&(c++,s+=d)),e=y}v--,F[w++]=U[v],n++}for(n=w;n<j;n++)F[n]=0;return F};return S.lzw=m,S}function Q(){if(E)return x;E=1,Object.defineProperty(x,"__esModule",{value:!0}),x.decompressFrames=x.decompressFrame=x.parseGIF=void 0;var m=o(K()),u=$(),t=H(),i=L(),d=N();function o(e){return e&&e.__esModule?e:{default:e}}var s=function(e){var r=new Uint8Array(e);return(0,u.parse)((0,t.buildStream)(r),m.default)};x.parseGIF=s;var c=function(e){for(var r=e.pixels.length,n=new Uint8ClampedArray(4*r),a=0;a<r;a++){var f=4*a,g=e.pixels[a],l=e.colorTable[g]||[0,0,0];n[f]=l[0],n[f+1]=l[1],n[f+2]=l[2],n[f+3]=g!==e.transparentIndex?255:0}return n},p=function(e,r,n){if(e.image){var a=e.image,f=a.descriptor.width*a.descriptor.height,g=(0,d.lzw)(a.data.minCodeSize,a.data.blocks,f);a.descriptor.lct.interlaced&&(g=(0,i.deinterlace)(g,a.descriptor.width));var l={pixels:g,dims:{top:e.image.descriptor.top,left:e.image.descriptor.left,width:e.image.descriptor.width,height:e.image.descriptor.height}};return a.descriptor.lct&&a.descriptor.lct.exists?l.colorTable=a.lct:l.colorTable=r,e.gce&&(l.delay=10*(e.gce.delay||10),l.disposalType=e.gce.extras.disposal,e.gce.extras.transparentColorGiven&&(l.transparentIndex=e.gce.transparentColorIndex)),n&&(l.patch=c(l)),l}console.warn("gif frame does not have associated image.")};x.decompressFrame=p;var y=function(e,r){return e.frames.filter(function(n){return n.image}).map(function(n){return p(n,e.gct,r)})};return x.decompressFrames=y,x}var q=Q();let _,z,V;function W(m,u){return _??=document.createElement("canvas"),_.width=m,_.height=u,_.getContext("2d",{willReadFrequently:!0})}async function De(m,u){const t=q.parseGIF(m),i=q.decompressFrames(t,!0),{width:d,height:o}=t.lsd,s=W(d,o),c=[],p=[];let y=0;for(const e of i){const r=J(e.delay||100);p.push(r),y+=r;const n=X(new ImageData(e.patch,e.dims.width,e.dims.height)),a=e.disposalType===3?s.getImageData(e.dims.left,e.dims.top,e.dims.width,e.dims.height):void 0;s.drawImage(n,e.dims.left,e.dims.top);const f=s.getImageData(0,0,d,o);c.push(f),e.disposalType===1||(e.disposalType===2?s.clearRect(e.dims.left,e.dims.top,e.dims.width,e.dims.height):e.disposalType===3&&s.putImageData(a,e.dims.left,e.dims.top))}return{frameCount:i.length,duration:y,frameDurations:p,getFrame:e=>c[e],width:d,height:o}}function X(m){return z??=document.createElement("canvas"),V??=z.getContext("2d",{willReadFrequently:!0}),z.width=m.width,z.height=m.height,V.putImageData(m,0,0),z}const Y=[71,73,70];function Z(m){const u=new Uint8Array(m);return!Y.some((t,i)=>t!==u[i])}function Ge(m){if(!Z(m))return!1;const u=new DataView(m),t=u.getUint8(10);let i=13+(128&t?3*2**(1+(7&t)):0),d=0,o=!1;for(;!o;){switch(u.getUint8(i++)){case 33:if(!s())return!1;break;case 44:c();break;case 59:o=!0;break;default:return!1}if(d>1)return!0}function s(){switch(u.getUint8(i++)){case 249:p();break;case 1:y();break;case 254:e();break;case 255:r();break;default:return!1}return!0}function c(){d++,i+=8;const a=u.getUint8(i++);i+=128&a?3*2**(1+(7&a)):0,i++,n()}function p(){i++,i+=4,n()}function y(){d++,i++,i+=12,n()}function e(){n()}function r(){i++,i+=8,i+=3,n()}function n(){let a;for(;a=u.getUint8(i++);)i+=a}return!1}export{Ge as isAnimatedGIF,Z as isGIF,De as parseGif};

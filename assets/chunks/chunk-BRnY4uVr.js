import{gW as E,lr as O,nA as A,g$ as k,lJ as m,ck as _,h0 as $,h5 as w,nB as j,t4 as B,gX as i,lG as S,lL as F,ha as T,h2 as M,hb as V,hd as C,h7 as G,hk as H,o$ as L,he as N,hm as I}from"./chunk-YzRi88Dj.js";import{u as U}from"./chunk-mQ0J7OJ8.js";import"./chunk-CMTIf1CS.js";import{u as J}from"./chunk-D4KI0uoT.js";import{T as W}from"./chunk-Ch0SDxT-.js";import{u as X}from"./chunk-D1eaHFcV.js";function q(){const e=E("vaSketch");if(!e)throw new Error("The component which use useSketch() must be in a Sketch component");return e}const v={modelValue:{type:[Array,Object],default:()=>[]},multiple:{type:Boolean,default:!0}},x=O(v),h={"update:modelValue":e=>e,complete:e=>e,update:e=>!0,create:e=>!0},z=A(h),D={...v,defaultOptions:{type:Object,default:()=>({})},availableCreatureTools:{type:Array,default:void 0},position:{type:String,default:"top-right"},orphan:{type:Boolean,default:!1},modelValueInitFrom:{type:String,default:"modelValue"},viewModelPointSymbol:{type:Object},viewModelPolygonSymbol:{type:Object},viewModelPolylineSymbol:{type:Object},viewModelActiveFillSymbol:{type:Object},visibleElements:{type:Object,default:void 0}},K=x,Q={load:e=>e,...h},R=z,Y=k({props:v,emits:h,setup(e,{emit:a}){const s=q(),n=J(),l=s.on("create",o=>{a("create",o),o.state==="start"?e.multiple||n.removeAll():o.state==="complete"&&(!e.multiple&&n.graphics.length>1&&o.graphic.geometry.type==="point"&&n.remove(n.graphics.getItemAt(0)),a("update:modelValue",[...n.graphics]),a("complete",o))});m(()=>{l.remove()});const c=s.on("update",o=>{a("update",o),o.state==="complete"&&(a("update:modelValue",[...n.graphics]),a("complete",o))});return m(()=>{c.remove()}),()=>null}}),Z=k({name:"VaSketch",components:{Events:Y},props:D,emits:Q,setup(e,{emit:a}){const s=U(),n=s.map;let l=E("vaGraphicsLayer",null);l||(l=new _,n.add(l),m(()=>{n.remove(l)}));const c=K(e),o=R(a);function p(t){l.removeAll(),l.addMany(t)}$(()=>e.modelValue,(t,r)=>{let u=!1;if(t.length===r.length){for(let d=0;d<t.length;d++)if(t[d]!==r[d]){u=!0;break}}else u=!0;u&&p([...t])}),e.modelValueInitFrom==="layerGraphics"?a("update:modelValue",l.graphics):p(e.modelValue);const f=w(),b=w(!1);class P extends W{toggleVisible(){n.ground.layers.forEach(r=>{r.visible=!r.visible})}add(){this.toggleVisible(),this.removeHandler=this.toggleVisible.bind(this)}}const g=new P;return j(()=>{const t=new B({container:f.value,view:s,layer:l,creationMode:"single",...e.defaultOptions});i(()=>{e.visibleElements&&(t.visibleElements=e.visibleElements)}),i(()=>{e.viewModelPointSymbol&&(t.viewModel.pointSymbol=e.viewModelPointSymbol)}),i(()=>{e.viewModelPolylineSymbol&&(t.viewModel.polylineSymbol=e.viewModelPolylineSymbol)}),i(()=>{e.viewModelPolygonSymbol&&(t.viewModel.polygonSymbol=e.viewModelPolygonSymbol)}),i(()=>{e.viewModelActiveFillSymbol&&(t.viewModel.activeFillSymbol=e.viewModelActiveFillSymbol)}),i(()=>{e.availableCreatureTools&&(t.availableCreateTools=e.availableCreatureTools)}),m(()=>{t.destroy()}),X(s.ui,t,e),S("vaGraphicsLayer",l),S("vaSketch",t),b.value=!0,g.add(),t.when(()=>{g.remove()}),a("load",{sketch:t,view:s})}),{eventsBindProps:c,eventsOnEmits:o,sketchNode:f,ready:b}}}),ee={ref:"sketchNode"};function te(e,a,s,n,l,c){const o=T("Events");return M(),V("div",ee,[e.ready?(M(),V(C,{key:0},[G(o,H(e.eventsBindProps,L(e.eventsOnEmits)),null,16),N(e.$slots,"default")],64)):I("",!0)],512)}const y=F(Z,[["render",te]]);y.install=e=>{e.component(y.name,y)};export{y as V};

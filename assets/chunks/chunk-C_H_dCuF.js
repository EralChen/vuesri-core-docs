const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chunks/chunk-B_bn5KxF.js","assets/chunks/chunk-ByM7454y.js","assets/chunks/chunk-CMhy9c9G.js","assets/static/ShadedColorMaterial.B02UECUJ.css","assets/static/uno-ff4db1d1.D2PgLIQl.css","assets/static/src_styles_common_reset-f7a68b0e.BAKp5MHC.css","assets/static/src_styles_common_color-a7a524c7.CVau4Kly.css","assets/static/src_styles_common_is-19c6c24d.DKAKruk7.css","assets/static/style-57df08cc.D7BtIwaj.css","assets/static/style-700e5873.Beul3IQx.css","assets/static/src_styles_element-plus_reset-752cc03d.htEpr2M-.css","assets/static/src_styles_element-plus_form-item-877afd6a.Dy4HJB2K.css","assets/static/src_styles_element-plus_table-6cbc5816.DXG1SsxY.css","assets/static/src_styles_element-plus_tabs-67d1a98b.BMDMQPDv.css","assets/static/src_styles_element-plus_tree-cc28503d.nmT5n0wM.css","assets/static/src_styles_element-plus_dialog-7f91a00e.D4nTsJge.css","assets/static/src_styles_element-plus_breadcrumb-8ce3a1a1.CwEEGJYc.css","assets/static/src_styles_element-plus_menu-33b44202.hFAFO4eV.css","assets/static/style-a19f1b3e.COrvIKje.css","assets/static/style-ea2b3f9e.BxAlKMJv.css","assets/static/style-283bc4f4.Cc2PI5FU.css","assets/static/style-c4a1f0b7.CdbLw5at.css","assets/static/src_styles_form_sub-7371c85e.y3zh-mS3.css","assets/static/src_styles_layout_index-2891f17b.BNCqvENj.css","assets/static/style-b3fe97a2.BuWAVw4m.css","assets/static/src_styles_vitepress_demo-827dc91c.Z0iQYynG.css","assets/static/style-0c254f43.BgXNzrGH.css","assets/static/style-d5a1a87d.BZwgKm1s.css","assets/static/style-f69381ee.CFNWXuiE.css","assets/static/style-b895e1ce.X9gIGpBH.css","assets/static/style-44d656df.Di2LGzYR.css","assets/static/style-fbf2e11d.CdbrDi0S.css","assets/static/src_styles_markdown_reset-fbd16bdd.D3vNaEcf.css","assets/static/src_layouts_default_aside-6ea01de8.BjbON5Ij.css","assets/static/vitepress_components_VPDocOutlineItem-4ff7b581.ADPwdkw3.css","assets/static/vitepress_components_VPDocAsideOutline-9eba9441.2-W4eQLy.css"])))=>i.map(i=>d[i]);
import{_ as I}from"./chunk-ByM7454y.js";import{j as g,s as f,M as L,N as P,Q as O,U as T,e as U,W as v}from"./chunk-CMhy9c9G.js";import{a as m,i as d,t as $}from"./chunk-C5OhRf_W.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */const C={FeatureLayer:!0,SceneLayer:!0};async function Se(t){const{properties:a,url:e}=t,s={...a,url:e},o=await F(e,a?.customParameters),{Constructor:r,layerId:n,sourceJSON:i,parsedUrl:c,layers:u,tables:l}=o;if(u.length+l.length===0)return n!=null&&(s.layerId=n),i!=null&&(s.sourceJSON=i),new r(s);const y=new(await I(async()=>{const{default:p}=await import("./chunk-B_bn5KxF.js");return{default:p}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35]))).default({title:c.title});return await _(y,o,s),y}function S(t,a){return t?t.find(({id:e})=>e===a):null}function b(t,a,e,s,o){const r={...o,layerId:a};return t!=null&&(r.url=t),e!=null&&(r.sourceJSON=e),"sublayerTitleMode"in s.prototype&&(r.sublayerTitleMode="service-name"),new s(r)}async function _(t,a,e){const s=a.sublayerConstructorProvider;for(const{id:o,serverUrl:r}of a.layers){const n=S(a.sublayerInfos,o),i=b(r,o,n,(n&&s?.(n))??a.Constructor,e);t.add(i)}if(a.tables.length){const o=await w("FeatureLayer");a.tables.forEach(({id:r,serverUrl:n})=>{const i=b(n,r,S(a.tableInfos,r),o,e);t.tables.add(i)})}}async function F(t,a){let e=g(t);if(e==null&&(e=await N(t,a)),e==null)throw new f("arcgis-layers:url-mismatch","The url '${url}' is not a valid arcgis resource",{url:t});const{serverType:s,sublayer:o}=e;let r;const n={FeatureServer:"FeatureLayer",KnowledgeGraphServer:"KnowledgeGraphLayer",StreamServer:"StreamLayer",VectorTileServer:"VectorTileLayer",VideoServer:"VideoLayer"},i=s==="FeatureServer",c=s==="SceneServer",u={parsedUrl:e,Constructor:null,layerId:i||c?o??void 0:void 0,layers:[],tables:[]};switch(s){case"MapServer":if(o!=null){const{type:l}=await m(t,{customParameters:a});switch(r="FeatureLayer",l){case"Catalog Layer":r="CatalogLayer";break;case"Catalog Dynamic Group Layer":throw new f("arcgis-layers:unsupported",`fromUrl() not supported for "${l}" layers`)}}else r=await k(t,a)?"TileLayer":"MapImageLayer";break;case"ImageServer":{const l=await m(t,{customParameters:a}),{tileInfo:y,cacheType:p}=l;r=y?y?.format?.toUpperCase()!=="LERC"||p&&p.toLowerCase()!=="elevation"?"ImageryTileLayer":"ElevationLayer":"ImageryLayer";break}case"SceneServer":{const l=await m(e.url.path,{customParameters:a});if(r="SceneLayer",l){const y=l?.layers;if(l?.layerType==="Voxel")r="VoxelLayer";else if(y?.length){const p=y[0]?.layerType;p!=null&&v[p]!=null&&(r=v[p])}}break}case"3DTilesServer":throw new f("arcgis-layers:unsupported","fromUrl() not supported for 3DTiles layers");case"FeatureServer":if(r="FeatureLayer",o!=null){const l=await m(t,{customParameters:a});u.sourceJSON=l,r=d(l.type)}break;default:r=n[s]}if(C[r]&&o==null){const l=await V(t,s,a);if(i&&(u.sublayerInfos=l.layerInfos,u.tableInfos=l.tableInfos),l.layers.length+l.tables.length!==1)u.layers=l.layers,u.tables=l.tables,i&&l.layerInfos?.length&&(u.sublayerConstructorProvider=await M(l.layerInfos));else if(i||c){const y=l.layerInfos?.[0]??l.tableInfos?.[0];if(u.layerId=l.layers[0]?.id??l.tables[0]?.id,u.sourceJSON=y,i){const p=y?.type;r=d(p)}}}return u.Constructor=await w(r),u}async function N(t,a){const e=await m(t,{customParameters:a});let s=null,o=null;const r=e.type;if(r==="Feature Layer"||r==="Table"?(s="FeatureServer",o=e.id??null):r==="indexedVector"?s="VectorTileServer":e.hasOwnProperty("mapName")?s="MapServer":e.hasOwnProperty("bandCount")&&e.hasOwnProperty("pixelSizeX")?s="ImageServer":e.hasOwnProperty("maxRecordCount")&&e.hasOwnProperty("allowGeometryUpdates")?s="FeatureServer":e.hasOwnProperty("streamUrls")?s="StreamServer":h(e)?(s="SceneServer",o=e.id):e.hasOwnProperty("layers")&&h(e.layers?.[0])&&(s="SceneServer"),!s)return null;const n=o!=null?L(t):null;return{title:n!=null&&e.name||P(t),serverType:s,sublayer:o,url:{path:n!=null?n.serviceUrl:O(t).path}}}function h(t){return t!=null&&t.hasOwnProperty("store")&&t.hasOwnProperty("id")&&typeof t.id=="number"}async function V(t,a,e){let s,o,r=!1;switch(a){case"FeatureServer":{const c=await $(t,{customParameters:e});r=!!c.layersJSON,s=c.layersJSON||c.serviceJSON;break}case"SceneServer":{const c=await J(t,e);s=c.serviceInfo,o=c.tableServerUrl;break}default:s=await m(t,{customParameters:e})}const n=s?.layers,i=s?.tables;return{layers:n?.map(c=>({id:c.id})).reverse()||[],tables:i?.map(c=>({serverUrl:o,id:c.id})).reverse()||[],layerInfos:r?n:[],tableInfos:r?i:[]}}async function J(t,a){const e=await m(t,{customParameters:a});if(!e.layers?.[0])return{serviceInfo:e};try{const{serverUrl:o}=await T(t),r=await m(o,{customParameters:a}).catch(()=>null);return r&&(e.tables=r.tables),{serviceInfo:e,tableServerUrl:o}}catch{return{serviceInfo:e}}}async function w(t){return(0,U[t])()}async function k(t,a){return(await m(t,{customParameters:a})).tileInfo}async function M(t){if(!t.length)return;const a=new Set,e=[];for(const{type:r}of t)a.has(r)||(a.add(r),e.push(w(d(r))));const s=await Promise.all(e),o=new Map;return Array.from(a).forEach((r,n)=>{o.set(r,s[n])}),r=>o.get(r.type)}export{Se as fromUrl};

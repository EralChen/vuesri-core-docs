import{bn as E,bo as I,bp as w,bq as c,br as b,bs as A,bt as R,bu as T,bv as g,bw as F,bx as y,by as h,bz as O,aZ as D}from"./chunk-CMhy9c9G.js";function Z(t,a,n=null){const e=[],s=a.mapPositions;d(a,e);const r=e[0][1].data,i=e[0][1].indices.length,o=E(i);return m(a,e,o),U(a,e,o),v(a,e,o),S(a,e,o),z(a,e,o),C(a,e,o),L(a,e,r),new I(t,e,s,w.Line,n)}function d(t,a){const{attributeData:{position:n},removeDuplicateStartEnd:e}=t,s=N(n)&&e,r=n.length/3-(s?1:0),i=new Array(2*(r-1)),o=s?n.slice(0,-3):n;let u=0;for(let f=0;f<r-1;f++)i[u++]=f,i[u++]=f+1;a.push([c.POSITION,new b(o,i,3,s)])}function m(t,a,n){if(t.attributeData.colorFeature!=null)return;const e=t.attributeData.color;a.push([c.COLOR,new b(e??A,n,4)])}function v(t,a,n){t.attributeData.normal&&a.push([c.NORMAL,new b(t.attributeData.normal,n,3)])}function S(t,a,n){t.attributeData.colorFeature!=null&&a.push([c.COLORFEATUREATTRIBUTE,new b([t.attributeData.colorFeature],n,1,!0)])}function U(t,a,n){t.attributeData.sizeFeature==null&&a.push([c.SIZE,new b([t.attributeData.size??1],n,1,!0)])}function z(t,a,n){t.attributeData.sizeFeature!=null&&a.push([c.SIZEFEATUREATTRIBUTE,new b([t.attributeData.sizeFeature],n,1,!0)])}function C(t,a,n){t.attributeData.opacityFeature!=null&&a.push([c.OPACITYFEATUREATTRIBUTE,new b([t.attributeData.opacityFeature],n,1,!0)])}function L(t,a,n){if(t.overlayInfo==null||t.overlayInfo.renderCoordsHelper.viewingMode!==R.Global||!t.overlayInfo.spatialReference.isGeographic)return;const e=T(n.length),s=g(t.overlayInfo.spatialReference);for(let l=0;l<e.length;l+=3)F(n,l,e,l,s);const r=n.length/3,i=y(r+1);let o=B,u=G,f=0,p=0;h(o,e[p++],e[p++]),p++,i[0]=0;for(let l=1;l<r+1;++l)l===r&&(p=0),h(u,e[p++],e[p++]),p++,f+=O(o,u),i[l]=f,[o,u]=[u,o];a.push([c.DISTANCETOSTART,new b(i,a[0][1].indices,1,!0)])}function N(t){const a=t.length;return t[0]===t[a-3]&&t[1]===t[a-2]&&t[2]===t[a-1]}const B=D(),G=D();function j(t,a){if(t==null||t.length===0)return[];const n=[];return t.forEach(e=>{const s=e.length,r=T(3*s);e.forEach((o,u)=>{r[3*u]=o[0],r[3*u+1]=o[1],r[3*u+2]=o[2]});const i={attributeData:{position:r,normal:a},removeDuplicateStartEnd:!1};n.push(i)}),n}export{j as R,Z as b};
